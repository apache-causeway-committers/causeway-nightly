<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>EventBusService :: Apache Isis</title>
    <meta name="generator" content="Antora 2.2.0">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="stylesheet" href="../../../_/css/site-custom.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i|Raleway:300,400,500,700,800|Montserrat:300,400,700" rel="stylesheet">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../..">
          <span class="icon">
            <img src="../../../_/img/isis-logo-48x48.png"></img>
          </span>
        <span>Apache Isis</span>
      </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <a class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Quick Start</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Starter Apps</span>
            <a class="navbar-item" href="../../../starters/helloworld/about.html">Hello World</a>
            <a class="navbar-item" href="../../../starters/simpleapp/about.html">Simple App</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Demos &amp; Tutorials</span>
            <a class="navbar-item" href="../../../demoapp/about.html">Demo App</a>
            <a class="navbar-item" href="https://danhaywood.gitlab.io/isis-petclinic-tutorial-docs/petclinic/1.16.2/intro.html">Petclinic (tutorial)</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Guides</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Core</span>
            <a class="navbar-item" href="../../../userguide/about.html">User Guide</a>
            <a class="navbar-item" href="../../../refguide/about.html">Reference Guide</a>
            <a class="navbar-item" href="../../../testing/about.html">Testing Guide</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Libraries</span>
            <a class="navbar-item" href="../../../subdomain/about.html">Subdomain Libraries</a>
            <a class="navbar-item" href="../../../valuetypes/about.html">Value Types</a>
            <a class="navbar-item" href="../../../mappings/about.html">Bounded Context Mapping Libraries</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Resources</span>
            <a class="navbar-item" href="../../../toc/devguide/about.html">Developers' Guide</a>
            <a class="navbar-item" href="../../../toc/mavendeps/about.html">Maven dependencies</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Components</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Viewers</span>
            <a class="navbar-item" href="../../../vw/about.html">Wicket UI</a>
            <a class="navbar-item" href="../../../vro/about.html">Restful Objects (REST)</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Security</span>
            <a class="navbar-item" href="../../../security/about.html">Security Guide</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Persistence</span>
            <a class="navbar-item" href="../../../odn/about.html">DataNucleus (JDO)</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Extensions</span>
            <a class="navbar-item" href="../../../extensions/about.html">Extensions Catalog</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Support</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Contact</span>
            <a class="navbar-item" href="../../../toc/support/slack-channel.html">Slack</a>
            <a class="navbar-item" href="../../../toc/support/mailing-list.html">Mailing Lists</a>
            <a class="navbar-item" href="https://issues.apache.org/jira/browse/ISIS">JIRA</a>
            <a class="navbar-item" href="https://stackoverflow.com/questions/tagged/isis">Stack Overflow</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Releases</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Releases</span>
            <a class="navbar-item" href="../../../toc/downloads/how-to.html">Downloads</a>
            <a class="navbar-item" href="../../../relnotes/about.html">Release Notes</a>
            <a class="navbar-item" href="../../../mignotes/about.html">Migration Notes</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">More Libraries</span>
            <a class="navbar-item" href="../../../incubator/about.html">Incubator</a>
            <a class="navbar-item" href="../../../legacy/about.html">Legacy</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Internal</span>
            <a class="navbar-item" href="../../../toc/comguide/about.html">Committers' Guide</a>
            <a class="navbar-item" href="../../../core/about.html">Core Design</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">ASF</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="http://www.apache.org/">Apache Homepage</a>
            <a class="navbar-item" href="https://www.apache.org/events/current-event">Events</a>
            <a class="navbar-item" href="https://www.apache.org/licenses/">Licenses</a>
            <a class="navbar-item" href="https://www.apache.org/security/">Security</a>
            <a class="navbar-item" href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a>
            <a class="navbar-item" href="https://www.apache.org/foundation/thanks.html">Thanks</a>
            <hr class="navbar-divider"/>
            <a class="navbar-item" href="https://whimsy.apache.org/board/minutes/Isis.html">PMC board minutes</a>
          </div>
        </div>
        <a class="navbar-item" href="../../../toc/about.html">
          <span class="icon">
            <img src="../../../_/img/home.png"></img>
          </span>
        </a>
      </div>
    </div>
  </nav>
</header>
<div class="body ">
<div class="nav-container" data-component="refguide" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../about.html">Reference Guide</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-text">Reference Guide</span>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../applib-ant/about.html">Annotations</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/Action.html">Action</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/ActionLayout.html">ActionLayout</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/Collection.html">Collection</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/CollectionLayout.html">CollectionLayout</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/Column.html">Column</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/Digits.html">Digits</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/Discriminator.html">Discriminator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/DomainObject.html">DomainObject</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/DomainObjectLayout.html">DomainObjectLayout</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/DomainService.html">DomainService</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/DomainServiceLayout.html">DomainServiceLayout</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/Facets.html">Facets</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/HomePage.html">HomePage</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/Inject.html">Inject</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/MemberGroupLayout.html">MemberGroupLayout</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/MemberOrder.html">MemberOrder</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/Mixin.html">Mixin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/NotPersistent.html">NotPersistent.</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/Nullable.html">Nullable</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/MinLength.html">MinLength</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/Parameter.html">Parameter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/ParameterLayout.html">ParameterLayout</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/Pattern.html">Pattern</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/PersistenceCapable.html">PersistenceCapable</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/PostConstruct.html">PostConstruct</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/PreDestroy.html">PreDestroy</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/PrimaryKey.html">PrimaryKey</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/Programmatic.html">Programmatic</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/Property.html">Property</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/PropertyLayout.html">PropertyLayout</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/RequestScoped.html">RequestScoped</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/Title.html">Title</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/ViewModel.html">ViewModel</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/ViewModelLayout.html">ViewModelLayout</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/XmlJavaTypeAdapter.html">XmlJavaTypeAdapter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-ant/XmlRootElement.html">XmlRootElement</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../about.html">Domain Services</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../presentation-layer-api.html">Presentation Layer API</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../presentation-layer-api/AcceptHeaderService.html">AcceptHeaderService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../presentation-layer-api/BookmarkUiService.html">BookmarkUiService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../presentation-layer-api/ConfigurationViewService.html">ConfigurationViewService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../presentation-layer-api/DeepLinkService.html">DeepLinkService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../presentation-layer-api/GuiceBeanProvider.html">GuiceBeanProvider</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../presentation-layer-spi.html">Presentation Layer SPI</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../presentation-layer-spi/ContentMappingService.html">ContentMappingService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../presentation-layer-spi/EmailNotificationService.html">EmailNotificationService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../presentation-layer-spi/ErrorReportingService.html">ErrorReportingService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../presentation-layer-spi/ExceptionRecognizer.html">ExceptionRecognizer</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../presentation-layer-spi/GridLoaderService.html">GridLoaderService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../presentation-layer-spi/GridService.html">GridService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../presentation-layer-spi/GridSystemService.html">GridSystemService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../presentation-layer-spi/HintStore.html">HintStore</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../presentation-layer-spi/LocaleProvider.html">LocaleProvider</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../presentation-layer-spi/MenuBarsLoaderService.html">MenuBarsLoaderService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../presentation-layer-spi/MenuBarsService.html">MenuBarsService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../presentation-layer-spi/RoutingService.html">RoutingService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../presentation-layer-spi/SessionLoggingService.html">SessionLoggingService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../presentation-layer-spi/TableColumnOrderService.html">TableColumnOrderService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../presentation-layer-spi/TranslationService.html">TranslationService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../presentation-layer-spi/TranslationsResolver.html">TranslationsResolver</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../presentation-layer-spi/UrlEncodingService.html">UrlEncodingService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../presentation-layer-spi/UserProfileService.html">UserProfileService</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../application-layer-api.html">Application Layer API</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../application-layer-api/BackgroundService.html">BackgroundService</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../application-layer-api/BackgroundService/BackgroundCommandExecution.html">BackgroundCommandExecution</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../application-layer-api/BackgroundService/Quartz.html">Quartz</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../application-layer-api/CommandContext.html">CommandContext</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../application-layer-api/DtoMappingHelper.html">DtoMappingHelper</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../application-layer-api/InteractionContext.html">InteractionContext</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../application-layer-api/MessageService.html">MessageService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../application-layer-api/SessionManagementService.html">SessionManagementService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../application-layer-api/TitleService.html">TitleService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../application-layer-api/TransactionService.html">TransactionService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../application-layer-api/WrapperFactory.html">WrapperFactory</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../application-layer-spi.html">Application Layer SPI</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../application-layer-spi/BackgroundCommandService.html">BackgroundCommandService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../application-layer-spi/CommandService.html">CommandService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../application-layer-spi/HomePageProviderService.html">HomePageProviderService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../application-layer-spi/HealthCheckService.html">HealthCheckService</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../core-domain-api.html">Core Domain API</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ClockService.html">ClockService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ConfigurationService.html">ConfigurationService</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="EventBusService.html">EventBusService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="FactoryService.html">FactoryService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="Scratchpad.html">Scratchpad.</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="UserService.html">UserService</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../integration-api.html">Integration API</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../integration-api/BookmarkService.html">BookmarkService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../integration-api/EmailService.html">EmailService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../integration-api/JaxbService.html">JaxbService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../integration-api/MementoService.html">MementoService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../integration-api/XmlSnapshotService.html">XmlSnapshotService</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../metadata-api.html">Metadata API</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../metadata-api/ApplicationFeatureRepository.html">ApplicationFeatureRepository</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../metadata-api/LayoutService.html">LayoutService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../metadata-api/MetamodelService.html">MetamodelService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../metadata-api/ServiceRegistry.html">ServiceRegistry</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../metadata-api/SwaggerService.html">SwaggerService</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../testing.html">Testing</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../testing/ExecutionParametersService.html">ExecutionParametersService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../testing/FixtureScripts.html">FixtureScripts</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../testing/FixtureScriptsSpecificationProvider.html">FixtureScriptsSpecificationProvider</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../testing/SudoService.html">SudoService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../testing/SwitchUserService.html">SwitchUserService</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../persistence-layer-api.html">Persistence Layer API</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../persistence-layer-api/HsqlDbManagerMenu.html">HsqlDbManagerMenu</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../persistence-layer-api/IsisJdoSupport.html">JdoSupport</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../persistence-layer-api/MetricsService.html">MetricsService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../persistence-layer-api/QueryResultsCache.html">QueryResultsCache</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../persistence-layer-api/RepositoryService.html">RepositoryService</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../persistence-layer-spi.html">Persistence Layer SPI</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../persistence-layer-spi/AuditerService.html">AuditerService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../persistence-layer-spi/PublisherService.html">PublisherService</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../persistence-layer-spi/UserRegistrationService.html">UserRegistrationService</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../bootstrapping-spi.html">Bootstrapping SPI</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../bootstrapping-spi/ClassDiscoveryService.html">ClassDiscoveryService</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../applib-cm/about.html">Classes &amp; Methods</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-cm/methods.html">Methods</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../applib-cm/classes.html">Classes</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../config/about.html">Configuration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../config/deployment-types.html">Deployment Types</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../config/configuration-files.html">Configuration Files</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../config/specifying-components.html">Specifying Components</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../config/configuring-core.html">Configuring Core</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../config/configuration-properties.html">Configuration Properties</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../schema/about.html">Schema</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../schema/mml.html">MetaModel</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../schema/cmd.html">Command</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../schema/ixn.html">Interaction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../schema/chg.html">Changes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../schema/common.html">Common</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Reference Guide</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title"> </span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../toc/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">BC Mappings Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../mappings/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Core Framework</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../core/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">DataNucleus ObjectStore</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../pjdo/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Extensions Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../extensions/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Incubator Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../incubator/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Legacy Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../legacy/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Reference Guide</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Restful Objects Viewer</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../vro/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Security Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../security/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Starter Apps</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../starters/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Subdomains Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../subdomains/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Testing Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../testing/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Tutorial App - Demo</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../demoapp/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">User Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../userguide/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Value Types Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../valuetypes/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Wicket Viewer</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../vw/about.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main role="main">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../toc/about.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../about.html">Reference Guide</a></li>
    <li><a href="../about.html">Domain Services</a></li>
    <li><a href="../core-domain-api.html">Core Domain API</a></li>
    <li><a href="EventBusService.html">EventBusService</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/apache/isis/edit/HEAD/api/applib/src/main/adoc/modules/applib-svc/pages/core-domain-api/EventBusService.adoc">Edit</a></div>
</div>
<article class="doc">
    <a name="section-top"></a>
<h1 class="page"><code>EventBusService</code></h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The <code>EventBusService</code> allows domain objects to emit events to subscribing domain services using an in-memory event bus.</p>
</div>
<div class="paragraph">
<p>The primary user of the service is the framework itself, which automatically emit events for <a href="../../applib-ant/Action.html#domainEvent" class="page">actions</a>, <a href="../../applib-ant/Property.html#domainEvent" class="page">properties</a> and <a href="../../applib-ant/Collection.html#domainEvent" class="page">collections</a>.
Multiple events are generated:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>when an object member is to be viewed, an event is fired; subscribers can veto (meaning that the member is hidden)</p>
</li>
<li>
<p>when an object member is to be enabled, the same event instance is fired; subscribers can veto (meaning that the member is disabled, ie cannot be edited/invoked)</p>
</li>
<li>
<p>when an object member is being validated, then a new event instance is fired; subscribers can veto (meaning that the candidate values/action arguments are rejected)</p>
</li>
<li>
<p>when an object member is about to be changed, then the same event instance is fired; subscribers can perform pre-execution operations</p>
</li>
<li>
<p>when an object member has been changed, then the same event instance is fired; subscribers can perform post-execution operations</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If a subscriber throws an exception in the first three steps, then the interaction is vetoed.
If a subscriber throws an exception in the last two steps, then the transaction is aborted.
For more on this topic, see <a href="../../applib-ant/Action.html#domainEvent" class="page"><code>@Action#domainEvent()</code></a>, <a href="../../applib-ant/Property.html#domainEvent" class="page"><code>@Property#domainEvent()</code></a> and <a href="../../applib-ant/Collection.html#domainEvent" class="page"><code>@Collection#domainEvent()</code></a>.</p>
</div>
<div class="paragraph">
<p>It is also possible for domain objects to programmatically generate domain events.
However the events are published, the primary use case is to decoupling interactions from one module/package/namespace and another.</p>
</div>
<div class="paragraph">
<p>Two implementations are available, using either <a href="https://code.google.com/p/guava-libraries/">Guava</a>'s <a href="https://code.google.com/p/guava-libraries/wiki/EventBusExplained"><code>EventBus</code></a>, or alternatively using the <a href="http://www.axonframework.org/">AxonFramework</a>'s <a href="http://www.axonframework.org/docs/2.4/single.html#d5e1489">SimpleEventBus</a>.  It is also possible to plug in a custom implementation.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api"><a class="anchor" href="#api"></a>API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The API defined by <code>EventBusService</code> is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public abstract class EventBusService {
    public void post(Object event) { /*...*/ }                          <i class="conum" data-value="1"></i><b>(1)</b>
    public void register(final Object domainService) { /*...*/ }        <i class="conum" data-value="2"></i><b>(2)</b>
    public void unregister(final Object domainService) { /*...*/ }      <i class="conum" data-value="3"></i><b>(3)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>posts the event onto event bus</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>allows domain services to register themselves.
This should be done in their <a href="../../applib-ant/PostConstruct.html" class="page"><code>@PostConstruct</code></a> initialization method (for both singleton and <a href="../../applib-ant/RequestScoped.html" class="page"><code>@RequestScoped</code></a> domain services.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>exists for symmetry, but need never be called (it is in fact deliberately a no-op).</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To use an alternative implementation, implement the <code>EventBusService</code> domain service and use Spring&#8217;s <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/core/annotation/Order.html"><code>@Order</code></a> annotation (as explained in the <a href="../about.html#overriding-the-services.adoc" class="page">introduction</a> to this guide).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="registering-subscribers"><a class="anchor" href="#registering-subscribers"></a>Registering Subscribers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>register()</code> method should be called in the <a href="../../applib-ant/PostConstruct.html" class="page"><code>@PostConstruct</code></a> lifecycle method.
It is valid and probably the least confusing to readers to also "unregister" in the <a href="../../applib-ant/PreDestroy.html" class="page"><code>@PreDestroy</code></a> lifecycle method (though as noted <a href="#api-and-implementation">above</a>, unregistering is actually a no-op).</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@DomainService(nature=NatureOfService.DOMAIN)   <i class="conum" data-value="1"></i><b>(1)</b>
@DomainServiceLayout( menuOrder="1")            <i class="conum" data-value="2"></i><b>(2)</b>
public class MySubscribingDomainService {

    @PostConstruct
    public void postConstruct() {
        eventBusService.register(this);         <i class="conum" data-value="3"></i><b>(3)</b>
    }

    @PreDestroy
    public void preDestroy() {
        eventBusService.unregister(this);       <i class="conum" data-value="4"></i><b>(4)</b>
    }

    // ...

    @javax.inject.Inject
    EventBusService eventBusService;
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>subscribers are typically not visible in the UI, so specify a <code>DOMAIN</code> nature</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>It&#8217;s important that subscribers register before any domain services that might emit events on the event bus service.
For example, the <a href="../../../security/about.html" class="page">SecMan extension</a> provides a domain service that automatically seeds certain domain entities; these will generate <a href="../../applib-cm/classes/lifecycleevent.html" class="page">lifecycle events</a> and so any subscribers must be registered before such seed services.
The easiest way to do this is to use the <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/core/annotation/Order.html"><code>@Order</code></a> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>register with the event bus service during <a href="../../applib-ant/PostConstruct.html" class="page"><code>@PostConstruct</code></a>
initialization</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>corresponding deregister when shutting down</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This works for both singleton (application-scoped) and also <a href="../../applib-ant/RequestScoped.html" class="page"><code>@RequestScoped</code></a> domain services.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="annotating-members"><a class="anchor" href="#annotating-members"></a>Annotating Members</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As discussed in the introduction, the framework will automatically emit domain events for all of the object members (actions, properties or collections) of an object whenever that object is rendered or (more generally) interacted with.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class Customer {
    @Action()
    public Customer placeOrder( Product product, int quantity) {
        // ...
    }
    // ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>will propagate an instance of the default <code>o.a.i.applib.services.eventbus.ActionDomainEvent.Default</code> class, which can then be subscribed to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.springframework.context.event.EventListener;

@DomainService(nature=NatureOfService.DOMAIN)
public class MySubscribingDomainService extends AbstractSubscriber {
    @EventListener(ActionDomainEvent.class)
    public void on(ActionDomainEvent ev) {
        // ...
    }
    // ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>More commonly though you will probably want to emit domain events of a specific subtype.
As a slightly more interesting example, suppose in a library domain that a <code>LibraryMember</code> wants to leave the library.
A letter should be sent out detailing any books that they still have out on loan:</p>
</div>
<div class="paragraph">
<p>In the <code>LibraryMember</code> class, we publish the event by way of an annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class LibraryMember {
    @Action(domainEvent=LibraryMemberLeaveEvent.class)  <i class="conum" data-value="1"></i><b>(1)</b>
    public void leave() {
        // ...
    }
    // ...
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>LibraryMemberLeaveEvent</code> is a subclass of <code>o.a.i.applib.eventbus.ActionDomainEvent</code>.  The topic of subclassing is discussed in more detail <a href="#event-hierarchy">below</a>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Meanwhile, in the <code>BookRepository</code> domain service, we subscribe to the event and act upon it.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.springframework.context.event.EventListener;

@DomainService(nature = NatureOfService.DOMAIN)
public class BookRepository extends AbstractSubscriber {

    @EventListener(LbraryMemberLeaveEvent.class)
    public void onLibraryMemberLeaving(LibraryMemberLeaveEvent e) {
        LibraryMember lm = e.getLibraryMember();
        List&lt;Book&gt; lentBooks = findBooksOnLoanFor(lm);
        if(!lentBooks.isEmpty()) {
            sendLetter(lm, lentBooks);
        }
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This design allows the <code>libraryMember</code> module to be decoupled from the <code>book</code> module.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="event-hierarchy"><a class="anchor" href="#event-hierarchy"></a>Event hierarchy</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By creating domain event subtypes we can be more semantically precise and in turn providesmore flexibility for subscribers: they can choose whether to be broadly applicable (by subscribing to a superclass) or to be tightly focussed (by subscribing to a subclass).</p>
</div>
<div class="paragraph">
<p>We recommend that you define event classes at (up to) four scopes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>at the top "global" scope is the Apache Isis-defined <code>o.a.i.applib.event.ActionDomainEvent</code></p>
</li>
<li>
<p>for the "module" scope, create a static class to represent the module itself, and creating nested classes within</p>
</li>
<li>
<p>for each "class" scope, create a nested static event class in the domain object&#8217;s class for all of the domain object&#8217;s actions</p>
</li>
<li>
<p>for each "action" scope, create a nested static event class for that action, inheriting from the "domain object" class.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To put all that into code; at the module level we can define:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package com.mycompany.modules.libmem;
...
public static class LibMemModule {
    private LibMemModule() {}
    public abstract static class ActionDomainEvent&lt;S&gt;
                extends org.apache.isis.applib.event.ActionDomainEvent&lt;S&gt; {}
    ...                                                                             <i class="conum" data-value="1"></i><b>(1)</b>
    public abstract static class PropertyDomainEvent&lt;S,T&gt;
                extends org.apache.isis.applib.event.PropertyDomainEvent&lt;S,T&gt; {}
    public abstract static class CollectionDomainEvent&lt;S,E&gt;
                extends org.apache.isis.applib.event.CollectionDomainEvent&lt;S,E&gt; {}
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>similar events for properties and collections should also be defined</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For the class-level we can define:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public static class LibraryMember {
    public abstract static class ActionDomainEvent
            extends LibMemModule.ActionDomainEvent&lt;LibraryMember&gt; { }
    ...                                                                             <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>similar events for properties and collections should also be defined</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>and finally at the action level we can define:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class LibraryMember {
    public static class LeaveEvent extends LibraryMember.ActionDomainEvent { }
    @Action(domainEvent=LeaveEvent.class)
    public void leave() {
        //...
    }
    // ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The subscriber can subscribe either to the general superclass (as before), or to any of the classes in the hierarchy.</p>
</div>
<div class="sect2">
<h3 id="variation-for-contributing-services"><a class="anchor" href="#variation-for-contributing-services"></a>Variation (for contributing services)</h3>
<div class="paragraph">
<p>A slight variation on this is to not fix the generic parameter at the class level, ie:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public static class LibraryMember {
    public abstract static class ActionDomainEvent&lt;S&gt;
            extends LibMemModule.ActionDomainEvent&lt;S&gt; { }
    // ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>and instead parameterize down at the action level:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class LibraryMember {
    public static class LeaveEvent
            extends LibraryMember.ActionDomainEvent&lt;LibraryMember&gt; { } <i class="conum" data-value="1"></i><b>(1)</b>

    @Action(domainEvent=LeaveEvent.class)
    public void leave() {
        // ...
    }

    // ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This then allows for other classes - in particular domain services contributing members - to also inherit from the class-level domain events.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="programmatic-posting"><a class="anchor" href="#programmatic-posting"></a>Programmatic posting</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To programmatically post an event, simply call <code>#post()</code>.</p>
</div>
<div class="paragraph">
<p>The <code>LibraryMember</code> example described above could for example be rewritten into:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class LibraryMember {
    @Action()
    public void leave() {
        // ...
        eventBusService.post(new LibraryMember.LeaveEvent(/*...*/));    <i class="conum" data-value="1"></i><b>(1)</b>
    }
    // ...
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>LibraryMember.LeaveEvent</code> could be <em>any</em> class, not just a subclass of <code>o.a.i.applib.event.ActionDomainEvent</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In practice we suspect there will be few cases where the programmatic approach is required rather than the declarative approach afforded by <a href="../../applib-ant/Action.html#domainEvent" class="page"><code>@Action#domainEvent()</code></a> et al.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-wrapperfactory"><a class="anchor" href="#using-wrapperfactory"></a>Using <code>WrapperFactory</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>An alternative way to cause events to be posted is through the <a href="../application-layer-api/WrapperFactory.html" class="page"><code>WrapperFactory</code></a>.
This is useful when you wish to enforce a (lack-of-) trust boundary between the caller and the callee.</p>
</div>
<div class="paragraph">
<p>For example, suppose that <code>Customer#placeOrder(&#8230;&#8203;)</code> emits a <code>PlaceOrderEvent</code>, which is subscribed to by a <code>ReserveStockSubscriber</code>.
This subscriber in turn calls <code>StockManagementService#reserveStock(&#8230;&#8203;)</code>.
Any business rules on <code>#reserveStock(&#8230;&#8203;)</code> should be enforced.</p>
</div>
<div class="paragraph">
<p>In the <code>ReserveStockSubscriber</code>, we therefore use the <code>WrapperFactory</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.springframework.context.event.EventListener;

@DomainService(nature=NatureOfService.DOMAIN)
public class ReserveStockSubscriber extends AbstractSubscriber{

    @EventListener(Customer.PlaceOrderEvent.class)
    public void on(Customer.PlaceOrderEvent ev) {
        wrapperFactory.wrap(stockManagementService)
                      .reserveStock(ev.getProduct(), ev.getQuantity());
    }

    @Inject
    StockManagementService stockManagementService;
    @Inject
    WrapperFactory wrapperFactory;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="implementation"><a class="anchor" href="#implementation"></a>Implementation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The framework provides a default implementation of the service, <code>o.a.i.objectstore.jdo.datanucleus.service.eventbus.EventBusServiceJdo</code>.</p>
</div>
<div class="sect2">
<h3 id="configuration-properties"><a class="anchor" href="#configuration-properties"></a>Configuration Properties</h3>
<div class="paragraph">
<p>The default implementation of this service defines the following configuration properties:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 50.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Value<br>
(default value)</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>isis.services.</code><br>
<code>eventbus.</code><br>
<code>implementation</code><br></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>guava</code>, <code>axon</code>,<br>
FQCN (<code><em>guava</em></code>)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>which implementation to use by the <a href="EventBusService.html" class="page"><code>EventBusService</code></a> as the underlying event bus.</p>
</div>
<div class="paragraph">
<p>The implementation of <code>EventBusService</code> provided by Apache Isis will by default use <a href="https://code.google.com/p/guava-libraries/">Guava</a>'s <a href="https://code.google.com/p/guava-libraries/wiki/EventBusExplained"><code>EventBus</code></a> as the underlying in-memory event bus.  Alternatively the <a href="http://www.axonframework.org/">AxonFramework</a>'s <a href="http://www.axonframework.org/docs/2.4/single.html#d5e1489">SimpleEventBus</a> can be used.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Guava vs Axon, which to use?</div>
<div class="paragraph">
<p>Guava actually queues up events; they are not guaranteed to be dispatched immediately.  This generally is not problem, but can be for cases where the subscriber may in turn want to post its own events (using <a href="../application-layer-api/WrapperFactory.html" class="page"><code>WrapperFactory</code></a>).</p>
</div>
<div class="paragraph">
<p>The Axon <code>SimpleEventBus</code>-based implementation on the other hand is fully synchronous; events are dispatched as soon as they are posted.  This works well in all scenarios (that we have tested).</p>
</div>
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>isis.services.</code><br>
<code>eventbus.</code><br>
<code>allowLate</code><br>
<code>Registration</code><br></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code>,<code>false</code><br>
(<code>false</code>)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>whether a domain service can register with the <a href="EventBusService.html" class="page"><code>EventBusService</code></a> after any events have posted.<br></p>
</div>
<div class="paragraph">
<p>Late registration refers to the idea that a domain service can register itself with the <code>EventBusService</code> after events have been posted.
Since domain services are set up at boot time, this almost certainly constitutes a bug in the code and so by default late registration is <em>not</em> allowed.
Setting the above property to <code>true</code> disables this check.</p>
</div>
<div class="paragraph">
<p>Since this almost certainly constitutes a bug in application code, by default this is disallowed.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="spi"><a class="anchor" href="#spi"></a>SPI</h3>
<div class="paragraph">
<p>It is also possible to define use some other underlying event bus implementation, by implementing the <code>EventBusImplementation</code> SPI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public interface EventBusImplementation {
    void register(Object domainService);
    void unregister(Object domainService);
    void post(Object event);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As is probably obvious, the <code>EventBusService</code> just delegates down to these method calls when its own similarly named methods are called.</p>
</div>
<div class="paragraph">
<p>If you do provide your own implementation of this SPI, be aware that your subscribers will need to use whatever convention is required (eg different annotations) such that the events are correctly routed through to your subscribers.</p>
</div>
<div class="paragraph">
<p>If you have written your own implementation of the <code>EventBusServiceImplementation</code> SPI, then specify instead its fully-qualified class name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ini hljs" data-lang="ini">isis.services.eventbus.implementation=com.mycompany.isis.MyEventBusServiceImplementation</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="related-services"><a class="anchor" href="#related-services"></a>Related Services</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>EventBusService</code> is intended for fine-grained publish/subscribe for object-to-object interactions within an Apache Isis domain object model. The event propagation is strictly in-memory, and there are no restrictions on the object acting as the event (it need not be serializable, for example).</p>
</div>
<div class="paragraph">
<p>The <a href="../persistence-layer-spi/PublisherService.html" class="page"><code>PublisherService</code></a> meanwhile is intended for coarse-grained publish/subscribe for system-to-system interactions, from Apache Isis to some other system. Here the only events published are those that action invocations (for actions annotated with <a href="../../applib-ant/Action.html#publishing" class="page"><code>@Action#publishing()</code></a>) and of changed objects (for objects annotated with <a href="../../applib-ant/DomainObject.html#publishing" class="page"><code>@DomainObject#publishing()</code></a>).</p>
</div>
</div>
</div>
</article>
<aside class="article-aside toc" role="navigation">
    <p class="toc-title">On this page</p>
    <div id="article-toc"></div>
</aside>
</main>
</div>
<footer class="footer">
    <div class="content">
        <div class="copyright">
            <p>
                Copyright © 2010~2019 The Apache Software Foundation, licensed under the Apache License, v2.0.
                <br/>
                Apache, the Apache feather logo, Apache Isis, and the Apache Isis project logo are all trademarks of The Apache Software Foundation.
            </p>
        </div>
        <div class="revision">
            <p>Revision: 2.0.0-M2.20200128-0400-34c50f5d</p>
        </div>
    </div>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/jquery-3.4.1.min.js"></script>
<script src="../../../_/js/vendor/jquery-ui-1.12.1.custom.widget-only.min.js"></script>
<script src="../../../_/js/vendor/jquery.tocify.min.js"></script>

<script>
    $(function() {
        $("#article-toc").tocify( {
            showEffect: "slideDown",
            hideEffect: "slideUp",
            selectors: "h2, h3",
            scrollTo: 120,
            smoothScroll: true,
            theme: "jqueryui",
            highlightOnScroll: true
        } );
    });
</script>
  </body>
</html>
