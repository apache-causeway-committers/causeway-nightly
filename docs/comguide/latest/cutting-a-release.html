<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Cutting a Release :: Apache Isis</title>
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../_/css/site.css">
    <link rel="stylesheet" href="../../_/css/site-custom.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i|Raleway:300,400,500,700,800|Montserrat:300,400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"/>
<link rel="home" href="../.." title="Apache Isis">
  <link rel="next" href="verifying-releases.html" title="Verifying Releases">
  <link rel="prev" href="updating-the-website.html" title="Updating the Website">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../..">
          <span class="icon">
            <img src="../../_/img/isis-logo-48x48.png"></img>
          </span>
        <span>Apache Isis</span>
      </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <a class="navbar-end">
        <div class="navbar-item hide-for-print">
          <span>
            <input id="algolia-search-input" placeholder="Search"></span>
          </span>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Quick Start</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Starter Apps</span>
            <a class="navbar-item" href="../../docs/2.0.0-M6/starters/helloworld.html">Hello World</a>
            <a class="navbar-item" href="../../docs/2.0.0-M6/starters/simpleapp.html">Simple App</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Demos &amp; Tutorials</span>
            <a class="navbar-item" href="../../docs/2.0.0-M6/demo/about.html">Demo App</a>
            <a class="navbar-item" href="https://danhaywood.gitlab.io/isis-petclinic-tutorial-docs/petclinic/1.16.2/intro.html">Petclinic (tutorial)</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Resources</span>
            <a class="navbar-item" href="../../docs/2.0.0-M6/resources/cheatsheet.html">Cheatsheet</a>
            <a class="navbar-item" href="../../docs/2.0.0-M6/resources/icons.html">Icons</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Guides</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Development</span>
            <a class="navbar-item" href="../../setupguide/2.0.0-M6/about.html">Setup Guide</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Core</span>
            <a class="navbar-item" href="../../userguide/2.0.0-M6/about.html">User Guide</a>
            <a class="navbar-item" href="../../refguide/2.0.0-M6/about.html">Reference Guide</a>
            <a class="navbar-item" href="../../testing/2.0.0-M6/about.html">Testing Guide</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Libraries</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">For Use in Apps</span>
            <a class="navbar-item" href="../../subdomains/2.0.0-M6/about.html">Subdomain Libraries</a>
            <a class="navbar-item" href="../../valuetypes/2.0.0-M6/about.html">Value Types</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Integrate between Apps</span>
            <a class="navbar-item" href="../../mappings/2.0.0-M6/about.html">Bounded Context Mapping Libraries</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Other</span>
            <a class="navbar-item" href="../../incubator/2.0.0-M6/about.html">Incubator</a>
            <a class="navbar-item" href="../../legacy/2.0.0-M6/about.html">Legacy</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Components</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Viewers</span>
            <a class="navbar-item" href="../../vw/2.0.0-M6/about.html">Web UI (Wicket)</a>
            <a class="navbar-item" href="../../vro/2.0.0-M6/about.html">REST API (Restful Objects)</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Security</span>
            <a class="navbar-item" href="../../security/2.0.0-M6/about.html">Security Guide</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Persistence</span>
            <a class="navbar-item" href="../../pjpa/2.0.0-M6/about.html">JPA (EclipseLink)</a>
            <a class="navbar-item" href="../../pjdo/2.0.0-M6/about.html">JDO (DataNucleus)</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Extensions</span>
            <a class="navbar-item" href="../../extensions/2.0.0-M6/about.html">Extensions Catalog</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Support</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Contact</span>
            <a class="navbar-item" href="../../docs/2.0.0-M6/support/slack-channel.html">Slack</a>
            <a class="navbar-item" href="../../docs/2.0.0-M6/support/mailing-list.html">Mailing Lists</a>
            <a class="navbar-item" href="https://issues.apache.org/jira/browse/ISIS">JIRA</a>
            <a class="navbar-item" href="https://stackoverflow.com/questions/tagged/isis">Stack Overflow</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Releases</span>
            <a class="navbar-item" href="../../docs/2.0.0-M6/downloads/how-to.html">Downloads</a>
            <a class="navbar-item" href="../../relnotes/2.0.0-M6/about.html">Release Notes</a>
            <a class="navbar-item" href="../../docs/2.0.0-M6/archive/1-x.html">Archive (1.x)</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Framework</span>
            <a class="navbar-item" href="../../conguide/2.0.0-M6/about.html">Contributors' Guide</a>
            <a class="navbar-item" href="../../comguide/2.0.0-M6/about.html">Committers' Guide</a>
            <a class="navbar-item" href="../../core/2.0.0-M6/about.html">Core Design</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">ASF</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="http://www.apache.org/">Apache Homepage</a>
            <a class="navbar-item" href="https://www.apache.org/events/current-event">Events</a>
            <a class="navbar-item" href="https://www.apache.org/licenses/">Licenses</a>
            <a class="navbar-item" href="https://www.apache.org/security/">Security</a>
            <a class="navbar-item" href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a>
            <a class="navbar-item" href="https://www.apache.org/foundation/thanks.html">Thanks</a>
            <hr class="navbar-divider"/>
            <a class="navbar-item" href="https://whimsy.apache.org/board/minutes/Isis.html">PMC board minutes</a>
          </div>
        </div>
        <a class="navbar-item" href="../../docs/2.0.0-M6/about.html">
          <span class="icon">
            <img src="../../_/img/home.png"></img>
          </span>
        </a>
      </div>
    </div>
  </nav>
</header>
<div class="body ">
<div class="nav-container" data-component="comguide" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-pagination">
  <a class="page-previous" rel="prev" href="updating-the-website.html" title="Updating the Website"><span></span></a>
  <a class="page-next" rel="next"
     href="verifying-releases.html" title="Verifying Releases"><span></span></a>
<!--
page.parent doesn't seem to be set...
  <a class="page-parent disabled" rel="prev" href="" title="Updating the Website"><span></span></a>
-->
</div>
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="about.html">Committers&#x27; Guide</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Occasionally</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="merging-a-pull-request.html">Merging a Pull Request</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="applying-patches.html">Applying Patches</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="updating-the-website.html">Updating the Website</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Release</span>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="cutting-a-release.html">Cutting a Release</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="verifying-releases.html">Verifying Releases</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Post Release</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="post-release-successful.html">Post Release (Successful)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="post-release-unsuccessful.html">Post Release (Unsuccessful)</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Appendices</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="key-generation.html">Key Generation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="algolia-search.html">Algolia Search</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="release-process-prereqs.html">Release Process Prereqs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="policies.html">Policies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pmc-notes.html">PMC Notes</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Committers&#x27; Guide</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title"> </span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">BC Mapping Libraries</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../mappings/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Committers' Guide</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Contributors' Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../conguide/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Design Docs</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../core/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Extensions Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../extensions/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Incubator Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../incubator/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">JDO/DataNucleus</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../pjdo/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">JPA</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../pjpa/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Reference Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../refguide/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Release Notes</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../relnotes/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">REST API (Restful Objects Viewer)</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../vro/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Security Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../security/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Setup Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../setupguide/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Subdomains Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../subdomains/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Testing Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../testing/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Tooling</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../tooling/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">User Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../userguide/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Value Types Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../valuetypes/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Web UI (Wicket Viewer)</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../vw/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main role="main">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../docs/latest/about.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="about.html">Committers' Guide</a></li>
    <li>Release</li>
    <li><a href="cutting-a-release.html">Cutting a Release</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/apache/isis/edit/master/antora/components/comguide/modules/ROOT/pages/cutting-a-release.adoc">Edit</a></div>
</div>
<article class="doc">
    <a name="section-top"></a>
<h1 class="page">Cutting a Release</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The release process consists of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the release manager cutting the release (documented below)</p>
</li>
<li>
<p>Members of the Apache Isis PMC <a href="verifying-releases.html" class="page">verifying</a> and voting on the release</p>
</li>
<li>
<p>the release manager performing post-release tasks, for either a <a href="post-release-successful.html" class="page">successful</a> or an <a href="post-release-unsuccessful.html" class="page">unsuccessful</a> vote.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Apache Isis itself is released in one go, everything is ultimately a child of <code>isis-parent/pom.xml</code> (relative to the <a href="https://github.com/apache/isis">source code root</a>).
This section details the process for formally releasing this module.</p>
</div>
<div class="paragraph">
<p>The subsequent sections describe how other committers can <a href="verifying-releases.html" class="page">verify a release</a> and how the release manager can then perform <a href="post-release-successful.html" class="page">post-release</a> activities and set up for the next development iteration.</p>
</div>
<div class="paragraph">
<p>If you&#8217;ve not performed a release before, then note that there are some configuration <a href="release-process-prereqs.html" class="page">prerequisites</a> that must be configured first.
In particular, you&#8217;ll need signed public/private keys, and the ASF Nexus staging repo inlocal <code>~/.m2/settings.xml</code> file.</p>
</div>
<div class="paragraph">
<p>These release notes using bash command line tools.
They should work on Linux and MacOS; for Windows, use mSysGit.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="preparation"><a class="anchor" href="#preparation"></a>Preparation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="obtain-consensus"><a class="anchor" href="#obtain-consensus"></a>Obtain Consensus</h3>
<div class="paragraph">
<p>Before releasing the framework, ensure there is consensus on the <a href="../../docs/latest/support/mailing-list.html" class="page">dev mailing list</a> that this is the right time for a release.
The discussion should include confirming the version number to be used, and to confirm content.</p>
</div>
<div class="paragraph">
<p>These discussions should also confirm the version number of the module being released.
This should be in line with our <a href="policies/versioning-policy.html#semantic-versioning" class="page">semantic versioning policy</a>.</p>
</div>
<div class="paragraph">
<p>Make sure you have a JIRA ticket open against which to perform all commits.
In most cases a JIRA ticket will have been created at the beginning of the previous release cycle.</p>
</div>
</div>
<div class="sect2">
<h3 id="pull-down-code-to-release"><a class="anchor" href="#pull-down-code-to-release"></a>Pull down code to release</h3>
<div class="paragraph">
<p>Set the HEAD of your local git repo to the commit to be released.
This will usually be the tip of the origin&#8217;s <code>master</code> branch:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git checkout master
git pull --ff-only</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="license-headers"><a class="anchor" href="#license-headers"></a>License headers</h3>
<div class="paragraph">
<p>The Apache Release Audit Tool <code>RAT</code> (from the <a href="http://creadur.apache.org">Apache Creadur</a> project) checks for missing license header files.
The parent <code>pom.xml</code> of each releasable module specifies the RAT Maven plugin, with a number of custom exclusions.</p>
</div>
<div class="paragraph">
<p>To run the RAT tool, use:</p>
</div>
<div class="listingblock">
<div class="title">find unapproved/missing licenses</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn clean

pushd isis-parent
mvn org.apache.rat:apache-rat-plugin:check -D rat.numUnapprovedLicenses=1000 -Dreleased
popd

for a in `/bin/find . -name rat.txt -print`; do grep '!???' $a; done &gt; /tmp/rat-qn.txt
for a in `/bin/find . -name rat.txt -print`; do grep '!AL' $a; done &gt; /tmp/rat-al.txt</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
the parent <code>pom.xml</code> in each of these locations has the <code>apache-rat-plugin</code> appropriately configured.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This script runs over all submodules, including non-released modules.</p>
</div>
<div class="paragraph">
<p>The command writes out a <code>target\rat.txt</code> for each submodule. missing license notes are indicated using the key <code>!???</code>.
The <code>for</code> command collates all the errors.</p>
</div>
<div class="paragraph">
<p>Investigate and fix any reported violations, typically by either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>adding genuinely missing license headers from Java (or other) source files, or</p>
</li>
<li>
<p>updating the <code>&lt;excludes&gt;</code> element for the <code>apache-rat-plugin</code> plugin to ignore test files, log files and any other non-source code files</p>
</li>
<li>
<p>also look to remove any stale <code>&lt;exclude&gt;</code> entries</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Once you&#8217;ve fixed all issues, run the script again to confirm that all license violations have been fixed.</p>
</div>
</div>
<div class="sect2">
<h3 id="missing-license-check"><a class="anchor" href="#missing-license-check"></a>Missing License Check</h3>
<div class="paragraph">
<p>Although Apache Isis has no dependencies on artifacts with incompatible licenses, the POMs for some of these dependencies (in the Maven central repo) do not necessarily contain the required license information.
Without appropriate additional configuration, this would result in the generated <code>DEPENDENCIES</code> file and generated Maven site indicating dependencies as having "unknown" licenses.</p>
</div>
<div class="paragraph">
<p>Fortunately, Maven allows the missing information to be provided by configuring the <code>maven-remote-resources-plugin</code>.
This is stored in the <code>src/main/appended-resources/supplemental-models.xml</code> file, relative to the root of each releasable module.</p>
</div>
<div class="paragraph">
<p>It&#8217;s first necessary to have built the framework locally at least once.</p>
</div>
<div class="paragraph">
<p>In the root directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn clean install -o -DskipTests</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once this is done, capture the missing license information using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn license:download-licenses
groovy scripts/checkmissinglicenses.groovy</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Maven plugin creates a <code>license.xml</code> file in the <code>target/generated-resources</code> directory of each module.
The script then searches for these <code>licenses.xml</code> files, and compares them against the contents of the <code>supplemental-models.xml</code> file.</p>
</div>
<div class="paragraph">
<p>For example, the output could be something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">licenses to add to supplemental-models.xml:

[org.slf4j, slf4j-api, 1.5.7]
[org.codehaus.groovy, groovy-all, 1.7.2]

licenses to remove from supplemental-models.xml (are spurious):

[org.slf4j, slf4j-api, 1.5.2]</code></pre>
</div>
</div>
<div class="paragraph">
<p>If any missing entries are listed or are spurious, then update <code>supplemental-models.xml</code> and try again.</p>
</div>
</div>
<div class="sect2">
<h3 id="update-and-preview-website"><a class="anchor" href="#update-and-preview-website"></a>Update and preview website</h3>
<div class="paragraph">
<p>Generate the website, ensuring that the config, examples, projdoc (system overview and global index) are all updated:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">sh preview.sh</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
this now needs to be run using Java 11 (because of the "projdoc" tooling).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Check for any Asciidoc errors, and fix.</p>
</div>
</div>
<div class="sect2">
<h3 id="commit-changes"><a class="anchor" href="#commit-changes"></a>Commit changes</h3>
<div class="paragraph">
<p>Commit any changes from the preceding steps:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git add ..
git commit -m "$ISISJIRA: updates to pom.xml etc for release"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="releasing-the-framework"><a class="anchor" href="#releasing-the-framework"></a>Releasing the Framework</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="set-environment-variables"><a class="anchor" href="#set-environment-variables"></a>Set environment variables</h3>
<div class="paragraph">
<p>We use environment variables to parameterize as many of the steps as possible.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export ISISJIRA=ISIS-9999                           <i class="conum" data-value="1"></i><b>(1)</b>
export ISISTMP=/c/tmp                               <i class="conum" data-value="2"></i><b>(2)</b>
export ISISREL=2.0.0-M6                             <i class="conum" data-value="3"></i><b>(3)</b>
export ISISRC=RC1                                   <i class="conum" data-value="4"></i><b>(4)</b>
export ISISBRANCH=release-$ISISREL-$ISISRC
export ISISART=isis
env | grep ISIS | sort</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>set to an "umbrella" ticket for all release activities.
(One should exist already, <a href="post-release-successful.html#create-new-jira" class="page">created at</a> the beginning of the development cycle now completing).</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>adjust by platform</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>adjust as required</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>adjust as necessary if this is not the first attempt to release</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The branch name is intentionally <strong>not</strong> the same as the eventual tag names (eg <code>isis-2.0.0-M6</code>).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="create-a-release-branch-and-worktree"><a class="anchor" href="#create-a-release-branch-and-worktree"></a>Create a release branch and worktree</h3>
<div class="paragraph">
<p>The release is performed on a branch; if we are successful, this branch will be merged back into master.</p>
</div>
<div class="paragraph">
<p>We also recommend performing this work in a separate git worktree.
The original worktree can stay with the <code>master</code> branch and be used for documentation fixes, etc.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>create (but don&#8217;t checkout) a release branch for the version number being released; eg:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git branch $ISISBRANCH</code></pre>
</div>
</div>
</li>
<li>
<p>Create a worktree for this branch:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git worktree add ../isis-release $ISISBRANCH</code></pre>
</div>
</div>
</li>
<li>
<p>Switch to the new worktree and push the branch:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cd ../isis-release
git push origin $ISISBRANCH -u</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="bump-code-to-isisrel"><a class="anchor" href="#bump-code-to-isisrel"></a>Bump code to <code>$ISISREL</code></h3>
<div class="paragraph">
<p>Search through the <code>.java</code> files for <code>2.0.0-M5</code>, and change to <code>2.0.0-M6</code>.</p>
</div>
<div class="paragraph">
<p>At the time of writing there are just a couple of files that have the release hard-coded.</p>
</div>
</div>
<div class="sect2">
<h3 id="switch-to-the-isis-parent-directory"><a class="anchor" href="#switch-to-the-isis-parent-directory"></a>Switch to the <code>isis-parent</code> directory</h3>
<div class="paragraph">
<p>The remainder of the release process is performed from the context of the <code>isis-parent</code> directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cd isis-parent</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="bump-projects-to-isisrel"><a class="anchor" href="#bump-projects-to-isisrel"></a>Bump projects to <code>$ISISREL</code></h3>
<div class="paragraph">
<p>We use <code>mvn versions:set</code> to manually bump the release version.
(After release, there is a <a href="#reset-revision-property">similar step at the end</a> to reset back to a <code>-SNAPSHOT</code> version).</p>
</div>
<div class="paragraph">
<p>(Still in the <code>isis-parent</code> directory), the steps are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>First we bump the framework&#8217;s <code>pom.xml</code> files:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn versions:set -DnewVersion=$ISISREL</code></pre>
</div>
</div>
</li>
<li>
<p>next we build the framework so that these versioned <code>pom.xml</code> files are available for the next step:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn install -o -DskipTests -Dreleased</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>released</code> system property is set to only sanity check the modules actually to be released (ignores the incubator modules).</p>
</div>
<div class="paragraph">
<p>Partly that&#8217;s because there&#8217;s no need to check the incubator modules, it&#8217;s also because the incubator modules require Java 11 (Java 8 is used for everything else)</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>next we also update the starters (as used by applications built using the framework):</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">pushd ../starters
mvn versions:set -DnewVersion=$ISISREL
mvn install -DskipTests -o
popd</code></pre>
</div>
</div>
</li>
<li>
<p>finally we commit the changes:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git add ..
git commit -m "$ISISJIRA: bumps version to $ISISREL"</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="sanity-check"><a class="anchor" href="#sanity-check"></a>Sanity check</h3>
<div class="paragraph">
<p>Perform one last sanity check on the codebase.
Delete all Isis artifacts from your local Maven repo, then build using the <code>-o</code> offline flag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">rm -rf ~/.m2/repository/org/apache/isis
mvn clean install -o -Dreleased
git clean -dfx ..</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="deploy"><a class="anchor" href="#deploy"></a>Deploy</h3>
<div class="paragraph">
<p>Since the <code>&lt;version&gt;</code> has already been updated, we just use <code>mvn deploy</code> to upload the artifacts.
We activate the (inherited) <code>apache-release</code> profile to bring in the <code>gpg</code> plugin for code signing.</p>
</div>
<div class="paragraph">
<p>The build creates a zip of the directory, so before executing the release we remove any other files.</p>
</div>
<div class="paragraph">
<p>Still in the <code>isis-parent</code> directory, we deploy (upload the artifacts) using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn deploy \
    -Dapache-release \
    -Dgit</code></pre>
</div>
</div>
<div class="paragraph">
<p>When prompted, enter your GPG passphrase.
(Or, it might be sufficient to add just <code>-Dgpg.passphrase="&#8230;&#8203;"</code>)</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This requires <code>gpg</code> v2.1 or later.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="tag-the-release"><a class="anchor" href="#tag-the-release"></a>Tag the Release</h3>
<div class="paragraph">
<p>Finally, tag the release:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git tag $ISISART-$ISISREL
git tag $ISISART-$ISISREL-$ISISRC</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="checkclose-staging-repo"><a class="anchor" href="#checkclose-staging-repo"></a>Check/Close Staging Repo</h3>
<div class="paragraph">
<p>The <code>mvn deploy</code> commands will have uploaded all of the release artifacts into a newly created staging repository on the ASF Nexus repository server.</p>
</div>
<div class="paragraph">
<p>Log onto <a href="http://repository.apache.org">repository.apache.org</a> (using your ASF LDAP account):</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/release-process/nexus-staging-0.png" alt="nexus staging 0" width="600px">
</div>
</div>
<div class="paragraph">
<p>And then check that the release has been staged (select <code>staging repositories</code> from left-hand side):</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/release-process/nexus-staging-1.png" alt="nexus staging 1" width="600px">
</div>
</div>
<div class="paragraph">
<p>If nothing appears in a staging repo you should stop here and work out why.</p>
</div>
<div class="paragraph">
<p>Assuming that the repo has been populated, make a note of its repo id; this is needed for the voting thread.
In the screenshot above the id is <code>org.apache.isis-008</code>.</p>
</div>
<div class="paragraph">
<p>After checking that the staging repository contains the artifacts that you expect you should close the staging repository.
This will make it available so that people can check the release.</p>
</div>
<div class="paragraph">
<p>Press the Close button and complete the dialog:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/release-process/nexus-staging-2.png" alt="nexus staging 2" width="600px">
</div>
</div>
<div class="paragraph">
<p>Nexus should start the process of closing the repository.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/release-process/nexus-staging-2a.png" alt="nexus staging 2a" width="600px">
</div>
</div>
<div class="paragraph">
<p>All being well, the close should (eventually) complete successfully (keep hitting refresh):</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/release-process/nexus-staging-3.png" alt="nexus staging 3" width="600px">
</div>
</div>
<div class="paragraph">
<p>The Nexus repository manager will also email you with confirmation of a successful close.</p>
</div>
<div class="paragraph">
<p>If Nexus has problems with the key signature, however, then the close will be aborted:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/release-process/nexus-staging-4.png" alt="nexus staging 4" width="600px">
</div>
</div>
<div class="paragraph">
<p>Use <code>gpg --keyserver hkp://pgp.mit.edu --recv-keys nnnnnnnn</code> to confirm that the key is available.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Unfortunately, Nexus does not seem to allow subkeys to be used for signing.
See <a href="key-generation.html" class="page">Key Generation</a> for more details.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="reset-revision-property"><a class="anchor" href="#reset-revision-property"></a>Reset <code>revision</code> property</h3>
<div class="paragraph">
<p>At the <a href="#bump-code-to-isisrel">beginning</a> of the release process we bumped the version to the release version, ie <code>$ISISREL</code>.
With the release now deployed we now need to reset the revision back down to the base snapshot, ie <code>2.0.0-SNAPSHOT</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Bumping back to <code>2.0.0-SNAPSHOT</code> (rather than the next development snapshot) simplifies CI/CD scripts for teams that want to building Apache Isis from source using git submodules.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Therefore (still in the <code>isis-parent</code> directory):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn versions:set -DnewVersion=2.0.0-SNAPSHOT
mvn install -DskipTests -o -Dreleased

pushd ../starters
mvn versions:set -DnewVersion=2.0.0-SNAPSHOT
mvn install -DskipTests -o
popd

git add ..
git commit -m "$ISISJIRA: resetting version"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="push-branch-tag"><a class="anchor" href="#push-branch-tag"></a>Push branch &amp; tag</h3>
<div class="paragraph">
<p>Push the release branch to origin:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git push -u origin $ISISBRANCH</code></pre>
</div>
</div>
<div class="paragraph">
<p>and also push tag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git push origin refs/tags/isis-$ISISREL:refs/tags/isis-$ISISREL-$ISISRC
git fetch</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The remote tags aren&#8217;t visible locally but can be seen <a href="https://github.com/apache/isis/tags">online</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="update-starter-apps"><a class="anchor" href="#update-starter-apps"></a>Update starter apps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For each of the two starter apps, we maintain four branches:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>jdo</code> and <code>jpa</code></p>
<div class="paragraph">
<p>These are intended to reference the <em>most recently released</em> version, the first demonstrating persistence using JDO, the second using JPA.
These are the branches referenced from the home page and getting started pages of the website.</p>
</div>
</li>
<li>
<p><code>jdo-SNAPSHOT</code> and <code>jpa-SNAPSHOT</code></p>
<div class="paragraph">
<p>These reference the most current snapshot nightly build.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The general idea is that a release will fast-forward <code>jdo</code> to <code>jdo-SNAPSHOT</code> and similarly moves <code>jpa</code> up to <code>jpa-SNAPSHOT</code>, bumping to the newly released version of the framework in the process.</p>
</div>
<div class="paragraph">
<p>In order that we don&#8217;t break the starter apps while a release is being voted on, we do the changes in work branches, <code>$ISISBRANCH-jdo</code> and <code>$ISISBRANCH-jpa</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>for <em>helloworld</em>, we create a release branch for both variants:</p>
<div class="ulist">
<ul>
<li>
<p>for <code>jdo</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git checkout jdo-SNAPSHOT
git pull --ff-only

git checkout -b $ISISBRANCH-jdo

mvn versions:update-parent -DparentVersion=$ISISREL <i class="conum" data-value="1"></i><b>(1)</b>
mvn versions:set -DnewVersion=$ISISREL

mvn clean install -o
mvn spring-boot:run</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>the top-level <code>pom.xml</code> references the ASF staging repository, so this will pull down the release if not already present in <code>~/.m2/repository</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Commit any changes and then push the branch to origin:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git add .
git commit -m "$ISISJIRA - updates to $ISISREL (jdo)"
git push -u origin $ISISBRANCH-jdo</code></pre>
</div>
</div>
</li>
<li>
<p>repeat for <code>jpa</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git checkout jpa-SNAPSHOT
git pull --ff-only

git checkout -b $ISISBRANCH-jpa

mvn versions:update-parent -DparentVersion=$ISISREL
mvn versions:set -DnewVersion=$ISISREL

mvn clean install -o
mvn spring-boot:run</code></pre>
</div>
</div>
<div class="paragraph">
<p>Commit any changes and then push the branch to origin:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git add .
git commit -m "$ISISJIRA - updates to $ISISREL (jpa)"
git push -u origin $ISISBRANCH-jpa</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>for <em>simple app</em>, the steps are almost the same:</p>
<div class="ulist">
<ul>
<li>
<p>for <code>jdo</code>:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git checkout jdo-SNAPSHOT
git pull --ff-only

git checkout -b $ISISBRANCH-jdo

mvn versions:update-parent -DparentVersion=$ISISREL <i class="conum" data-value="1"></i><b>(1)</b>
mvn versions:set -DnewVersion=$ISISREL

mvn clean install -Dmetamodel.lockdown -B -o        <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>the top-level <code>pom.xml</code> references the ASF staging repository, so this will pull down the release if not already present in <code>~/.m2/repository</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>the -B flag is required to avoid control characters in generated output</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Approve any failed lockdown tests (the mavendeps will fail first time around because the dependencies on Apache Isis itself have just be bumped).</p>
</div>
<div class="paragraph">
<p>You could also check the output of the Cucumber tests, under:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>webapp-tests/target/cucumber-reports</code> and</p>
</li>
<li>
<p><code>webapp-tests/target/cucumber-html-reports</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Repeat, then run the app as a sanity check:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn -pl webapp spring-boot:run</code></pre>
</div>
</div>
<div class="paragraph">
<p>Commit any changes and then push the branch to origin:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git add .
git commit -m "$ISISJIRA - updates to $ISISREL (jdo)"
git push -u origin $ISISBRANCH-jdo</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>repeat for <code>jpa</code>:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git checkout jpa-SNAPSHOT
git pull --ff-only

git checkout -b $ISISBRANCH-jpa

mvn versions:update-parent -DparentVersion=$ISISREL
mvn versions:set -DnewVersion=$ISISREL

mvn clean install -Dmetamodel.lockdown -B -o</code></pre>
</div>
</div>
<div class="paragraph">
<p>Approve any failed lockdown tests (the mavendeps will fail first time around because the dependencies on Apache Isis itself have just be bumped).</p>
</div>
<div class="paragraph">
<p>Repeat, then run the app as a sanity check:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn -pl webapp spring-boot:run</code></pre>
</div>
</div>
<div class="paragraph">
<p>Commit any changes and then push the branch to origin:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git add .
git commit -m "$ISISJIRA - updates to $ISISREL (jpa)"
git push -u origin $ISISBRANCH-jpa</code></pre>
</div>
</div>
</div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="preview-website"><a class="anchor" href="#preview-website"></a>Preview website</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We also prepare a preview of the next version of the website, then made accessible from <a href="https://isis.staged.apache.org" class="bare">https://isis.staged.apache.org</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Prerequisites:</p>
<div class="ulist">
<ul>
<li>
<p>clone the <a href="https://github.com/apache/isis-site" class="bare">https://github.com/apache/isis-site</a> repo, alongside the <code>isis</code> repo:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git clone https://github.com/apache/isis-site ../isis-site</code></pre>
</div>
</div>
</li>
<li>
<p>in the <code>isis-site</code> repo, check out the <code>asf-staging</code> branch:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cd ../isis-site

git checkout asf-staging
git pull --ff-only</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>still in the <code>isis-site</code> repo, delete all the files in <code>content/</code> <em>except</em> for the <code>schema</code> and <code>versions</code> directories:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">pushd content
for a in $(ls -1 | grep -v schema | grep -v versions)
do
    rm -rf $a
done
popd</code></pre>
</div>
</div>
</li>
<li>
<p>Back in the <code>isis</code> repo&#8217;s <code>release</code> worktree, generate the Antora site (from the top-level directory).</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
this now needs to be run using Java 11 (because of the "projdoc" tooling).
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cd ../isis-release

sh preview.sh</code></pre>
</div>
</div>
</li>
<li>
<p>Copy the generated Antora site to <code>isis-site</code> repo&#8217;s <code>contents</code> directory:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cp -Rf antora/target/site/* ../isis-site/content/.</code></pre>
</div>
</div>
</li>
<li>
<p>Back in the <code>isis-site</code> repo, commit the changes and preview:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cd ../isis-site

git add .
git commit -m "$ISISJIRA : staging changes to website"

sh preview.sh</code></pre>
</div>
</div>
</li>
<li>
<p>If happy, then push the changes:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git push origin asf-staging -u</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Wait a minute or two; the site should be available at <a href="https://isis.staged.apache.org" class="bare">https://isis.staged.apache.org</a>  (nb: 'staged', not 'staging').</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="voting"><a class="anchor" href="#voting"></a>Voting</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once the artifacts have been uploaded, you can call a vote.</p>
</div>
<div class="paragraph">
<p>In all cases, votes last for 72 hours and require a +3 (binding) vote from members.</p>
</div>
<div class="sect2">
<h3 id="start-voting-thread-on-dev-mailing-list"><a class="anchor" href="#start-voting-thread-on-dev-mailing-list"></a>Start voting thread on dev mailing list</h3>
<div class="paragraph">
<p>That is, <a href="mailto:dev@apache.isis.org" class="bare">mailto:dev@apache.isis.org</a></p>
</div>
<div class="paragraph">
<p>The following boilerplate is for a release of the Apache Isis Core.
Adapt as required:</p>
</div>
<div class="paragraph">
<p>Use the following subject, eg:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>[VOTE] Apache Isis Core release 2.0.0-M6 RC1</code></pre>
</div>
</div>
<div class="paragraph">
<p>And use the following body:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>I've just cut a new release of the Apache Isis Framework.

The source code zip artifact has been uploaded to a staging repository on
https://repository.apache.org, along with its corresponding .asc signature.

In the source code repo the code has been tagged as isis-2.0.0-M6-RC1;
see https://github.com/apache/isis/tags

To verify the source code itself, you can use the following commands
(in an empty directory):

----------------------------------------------------------------
VERSION=2.0.0-M6
RC=RC1
NEXUSREPONUM=11xx

curl https://downloads.apache.org/isis/KEYS &gt; /tmp/KEYS
gpg --import /tmp/KEYS

rm -rf isis-$VERSION

curl -O -L https://raw.githubusercontent.com/apache/isis/release-$VERSION-$RC/scripts/verify-isis-release.sh

chmod +x ./verify-isis-release.sh
./verify-isis-release.sh $NEXUSREPONUM $VERSION $RC
----------------------------------------------------------------

You can then test the helloworld or simpleapp starter apps, see:
https://isis.staged.apache.org/comguide/latest/verifying-releases.html.

You can also inspect the website in general, available at:
https://isis.staged.apache.org.

Please verify the release and cast your vote.
The vote will be open for a minimum of 72 hours.

[ ] +1
[ ]  0
[ ] -1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Remember to update:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the version number (<code>2.0.0-M6</code> or whatever)</p>
</li>
<li>
<p>the release candidate number (<code>RC1</code> or whatever)</p>
</li>
<li>
<p>the <code>NEXUSREPONUM</code> to the repository id as provided by Nexus earlier (<code>11xx</code> or whatever)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that the email also references the procedure for other committers to <a href="verifying-releases.html" class="page">verify the release</a>.</p>
</div>
</div>
</div>
</div>
</article>
<aside class="article-aside toc hide-for-print" role="navigation">
    <p class="toc-title">On this page</p>
    <div id="article-toc"></div>
</aside>
</main>
</div>
<footer class="footer">
    <div class="content">
        <div class="copyright">
            <p>
                Copyright  2010~2021 The Apache Software Foundation, licensed under the Apache License, v2.0.
                <br/>
                Apache, the Apache feather logo, Apache Isis, and the Apache Isis project logo are all trademarks of The Apache Software Foundation.
            </p>
        </div>
        <div class="revision">
            <p>Revision: 2.0.0-M5.20210622-0232-6b87fe9f</p>
        </div>
    </div>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script src="../../_/js/vendor/jquery-3.4.1.min.js"></script>
<script src="../../_/js/vendor/jquery-ui-1.12.1.custom.widget-only.min.js"></script>
<script src="../../_/js/vendor/jquery.tocify.min.js"></script>

<script>
    $(function() {
        $("#article-toc").tocify( {
            showEffect: "slideDown",
            hashGenerator: "pretty",
            hideEffect: "slideUp",
            selectors: "h2, h3",
            scrollTo: 120,
            smoothScroll: true,
            theme: "jqueryui",
            highlightOnScroll: true
        } );
    });
</script>

<script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script>
  function focusSearchInput () { document.querySelector('#algolia-search-input').focus() }
  var search = docsearch({
    appId: '5ISP5TFAEN',
    apiKey: '0fc51c28b4ad46e7318e96d4e97fab7c',
    indexName: 'isis-apache-org',
    inputSelector: '#algolia-search-input',
    autocompleteOptions: { hint: false, keyboardShortcuts: ['s'] },
    debug: false,
  }).autocomplete
  search.on('autocomplete:closed', function () { search.autocomplete.setVal() })
  focusSearchInput()
  window.addEventListener('load', focusSearchInput);
</script>

<!--
  docsearch options:
  https://docsearch.algolia.com/docs/behavior/
-->
<!--
  https://www.algolia.com/doc/api-reference/api-parameters/
  algoliaOptions: { hitsPerPage: 6 },
-->
  </body>
</html>
