<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>From v1.9.0 to 1.10.0 :: Apache Isis</title>
    <link rel="canonical" href="https://isis.apache.org/mignotes/mn-1.9.0-to-1.10.0.html">
    <meta name="generator" content="Antora 2.0.0">
    <link rel="stylesheet" href="../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://isis.apache.org">Apache Isis</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="mignotes" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="about.html">Migration Notes</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="about.html">Migration Notes</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Migration Notes</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">Architecture & Design</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../archdesign/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">DataNucleus ObjectStore</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../odn/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Example App - Demo</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../demoapp/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Example App - Hello World</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../helloworld/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Example App - SimpleApp</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../simpleapp/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Extensions - SecMan</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../ext-secman/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Fundamentals & Beyond</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../ug/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Guides - Reference Guides</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../rg/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Maven Dependencies</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../mavendeps/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Migration Notes</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Release Notes</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../relnotes/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Restful Objects Viewer</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../vro/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Runtime Services</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../runtime-services/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Security</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../security/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">SmokeTest App</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../smoketests/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Table of Contents</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../toc/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Testing</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../testing/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Wicket Viewer</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../vw/about.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main>
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../toc/about.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="about.html">Migration Notes</a></li>
    <li><a href="mn-1.9.0-to-1.10.0.html">From v1.9.0 to 1.10.0</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///home/hobrom/antora/isis/antora/components/mignotes/modules/ROOT/pages/mn-1.9.0-to-1.10.0.adoc">Edit this Page</a></div>
  </div>
<article class="doc">
<h1 class="page">From v1.9.0 to 1.10.0</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Existing projects written against v1.9.0 should run against v1.10.0 with only a few minor changes.
If you <strong>do</strong> encounter any difficulties then let us know via the <a href="https://isis.apache.org/versions/1.10.0/support.html#">users mailing list</a>, so we can support you and document issues here.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="remove-references-to-isis-viewer-wicket-parent-pom"><a class="anchor" href="#remove-references-to-isis-viewer-wicket-parent-pom"></a>Remove references to <code>isis-viewer-wicket</code> parent pom.</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In earlier releases the Wicket viewer defined its own parent <code>pom.xml</code> for dependency management and its dependencies
and to declare the various submodules that make up the viewer.  This <code>pom.xml</code> has now been incorporated into the
parent <code>pom.xml</code> for the Core framework.</p>
</div>
<div class="paragraph">
<p>Therefore, in the parent <code>pom.xml</code> of your own domain applications, remove:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependencyManagement&gt;
    &lt;dependencies&gt;
        ...
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.isis.viewer&lt;/groupId&gt;
            &lt;artifactId&gt;isis-viewer-wicket&lt;/artifactId&gt;
            &lt;version&gt;${isis.version}&lt;/version&gt;
            &lt;type&gt;pom&lt;/type&gt;
            &lt;scope&gt;import&lt;/scope&gt;
        &lt;/dependency&gt;
        ...
    &lt;/dependencies&gt;
&lt;/dependencyManagement&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="allowlateregistration"><a class="anchor" href="#allowlateregistration"></a><code>allowLateRegistration</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>One possible issue is that (as per <a href="https://issues.apache.org/jira/browse/ISIS-830">ISIS-830</a>) the <a href="https://isis.apache.org/versions/1.10.0/guides/rgsvc/rgsvc.html#_rgsvc_core-domain-api_EventBusService"><code>EventBusService</code></a> is now initialized as one of the first domain
services; this is to ensure that any object lifecycle events caused by domain services initializing themselves can be
posted on the event bus for subscribers.  The typical case for such lifecycle events to occur is from domain services
that seed reference data; one such example can be found in the (non-ASF) <a href="https://platform.incode.org" target="_blank" rel="noopener">Incode Platform</a>'s security module.</p>
</div>
<div class="paragraph">
<p>In previous releases, the ordering of initialization for the <code>EventBusService</code> was undefined (but would typically be towards the
"end" of the list of services.  What this meant in practice is that it generally didn&#8217;t matter whether (domain service)
subscribers were initialized before or after seed services.</p>
</div>
<div class="paragraph">
<p>Now, though, because the <code>EventBusService</code> is initialized early on, it proactively checks that all subscribers have
been registered before any event posts occur (so that no events get missed).  If any subscriber attempts to register
after at least one event has been posted, then the service will fail fast and the framework will not start.  The error looks something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-log hljs" data-lang="log">: EXEC
org.isisaddons.module.security.seed.scripts.IsisModuleSecurityAdminUser
seed-users-and-roles-fixture-script/isis-applib-fixture-results-role-and-permissions
: EXEC
org.isisaddons.module.security.seed.scripts.IsisApplibFixtureResultsRoleAndPermissions
19:41:19,478  [IsisTransaction      main       INFO ]  abort transaction
IsisTransaction@5dc1597f[state=MUST_ABORT,commands=1]
19:41:19,495  [IsisWicketApplication main       ERROR]  Failed to initialize
com.google.inject.ProvisionException: Guice provision errors:

1) Error in custom provider,
org.apache.isis.core.runtime.system.transaction.IsisTransactionManagerException:
java.lang.IllegalStateException: Events have already been posted; too late
to register any further (singleton) subscribers
  at
org.apache.isis.core.runtime.runner.IsisInjectModule.provideIsisSystem(IsisInjectModule.java:139)</code></pre>
</div>
</div>
<div class="paragraph">
<p>To ensure that subscriber domain services are initialized before "seed" domain services, the <a href="https://isis.apache.org/versions/1.10.0/guides/rgant/rgant.html#_rgant-DomainServiceLayout_menuOrder"><code>@DomainServiceLayout#menuOrder()</code></a> attribute can be used.
Normally this attribute is just used to order UI-visible services on the menu bars, but it also is used
internally to sequence the internal list of services being initialized.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can disable this checking within the <code>EventBusService</code> using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ini hljs" data-lang="ini">isis.services.eventbus.allowLateRegistration=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you do that, be aware that not all subscribers may not receive some events generated by other domain services.</p>
</div>
<div class="paragraph">
<p>For more details, see the <a href="https://isis.apache.org/versions/1.10.0/guides/rgsvc/rgsvc.html#_rgsvc_core-domain-api_EventBusService"><code>EventBusService</code></a> man page.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="simplify-domain-events"><a class="anchor" href="#simplify-domain-events"></a>Simplify domain events</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The domain event superclasses now provide no-arg versions; the framework will use new (non-API) setters to initialize.</p>
</div>
<div class="paragraph">
<p>This means that domain events can be substantially simplified, eg from this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class ToDoItem {
    public static class CompletedEvent extends ActionDomainEvent&lt;ToDoItem&gt; {
        private static final long serialVersionUID = 1L;
        public CompletedEvent(
                final ToDoItem source,
                final Identifier identifier,
                final Object... arguments) {
            super("completed", source, identifier, arguments);
        }
    }
    @Action(domainEvent=CompletedEvent.class)
    public ToDoItem completed() { /* ... */ }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>to just this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class ToDoItem {
    public static class CompletedEvent extends ActionDomainEvent&lt;ToDoItem&gt; { }  <i class="conum" data-value="1"></i><b>(1)</b>
    @Action(domainEvent=CompletedEvent.class)
    public ToDoItem completed() { /* ... */ }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="isis-maven-plugin"><a class="anchor" href="#isis-maven-plugin"></a>isis-maven-plugin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The way that the Isis Maven plugin is configured has changed slightly; check out its <a href="https://isis.apache.org/versions/1.10.0/guides/rgmvn/rgmvn.html#">documentation</a> for full details.</p>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
