<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Deployment :: Apache Isis</title>
    <meta name="generator" content="Antora 2.2.0">
    <link rel="stylesheet" href="../../_/css/site.css">
    <link rel="stylesheet" href="../../_/css/site-custom.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i|Raleway:300,400,500,700,800|Montserrat:300,400,700" rel="stylesheet">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../..">
          <span class="icon">
            <img src="../../_/img/isis-logo-48x48.png"></img>
          </span>
        <span>Apache Isis</span>
      </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <a class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Quick Start</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Starter Apps</span>
            <a class="navbar-item" href="../../docs/starters/helloworld.html">Hello World</a>
            <a class="navbar-item" href="../../docs/starters/simpleapp.html">Simple App</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Demos &amp; Tutorials</span>
            <a class="navbar-item" href="../../docs/demoapp/about.html">Demo App</a>
            <a class="navbar-item" href="https://danhaywood.gitlab.io/isis-petclinic-tutorial-docs/petclinic/1.16.2/intro.html">Petclinic (tutorial)</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Resources</span>
            <a class="navbar-item" href="../../docs/resources/cheatsheet.html">Cheatsheet</a>
            <a class="navbar-item" href="../../docs/resources/icons.html">Icons</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Guides</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Development</span>
            <a class="navbar-item" href="../../docs/setupguide/about.html">Setup Guide</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Core</span>
            <a class="navbar-item" href="../../userguide/about.html">User Guide</a>
            <a class="navbar-item" href="../../refguide/about.html">Reference Guide</a>
            <a class="navbar-item" href="../../testing/about.html">Testing Guide</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Libraries</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">For Use in Apps</span>
            <a class="navbar-item" href="../../subdomain/about.html">Subdomain Libraries</a>
            <a class="navbar-item" href="../../valuetypes/about.html">Value Types</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Integrate between Apps</span>
            <a class="navbar-item" href="../../mappings/about.html">Bounded Context Mapping Libraries</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Other</span>
            <a class="navbar-item" href="../../incubator/about.html">Incubator</a>
            <a class="navbar-item" href="../../legacy/about.html">Legacy</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Components</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Viewers</span>
            <a class="navbar-item" href="../../vw/about.html">Wicket UI</a>
            <a class="navbar-item" href="../../vro/about.html">Restful Objects (REST)</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Security</span>
            <a class="navbar-item" href="../../security/about.html">Security Guide</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Persistence</span>
            <a class="navbar-item" href="../../odn/about.html">DataNucleus (JDO)</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Extensions</span>
            <a class="navbar-item" href="../../extensions/about.html">Extensions Catalog</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Support</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Contact</span>
            <a class="navbar-item" href="../../docs/support/slack-channel.html">Slack</a>
            <a class="navbar-item" href="../../docs/support/mailing-list.html">Mailing Lists</a>
            <a class="navbar-item" href="https://issues.apache.org/jira/browse/ISIS">JIRA</a>
            <a class="navbar-item" href="https://stackoverflow.com/questions/tagged/isis">Stack Overflow</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Releases</span>
            <a class="navbar-item" href="../../docs/downloads/how-to.html">Downloads</a>
            <a class="navbar-item" href="../../relnotes/about.html">Release Notes</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Framework</span>
            <a class="navbar-item" href="../../docs/conguide/about.html">Contributors' Guide</a>
            <a class="navbar-item" href="../../docs/comguide/about.html">Committers' Guide</a>
            <a class="navbar-item" href="../../core/about.html">Core Design</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">ASF</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="http://www.apache.org/">Apache Homepage</a>
            <a class="navbar-item" href="https://www.apache.org/events/current-event">Events</a>
            <a class="navbar-item" href="https://www.apache.org/licenses/">Licenses</a>
            <a class="navbar-item" href="https://www.apache.org/security/">Security</a>
            <a class="navbar-item" href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a>
            <a class="navbar-item" href="https://www.apache.org/foundation/thanks.html">Thanks</a>
            <hr class="navbar-divider"/>
            <a class="navbar-item" href="https://whimsy.apache.org/board/minutes/Isis.html">PMC board minutes</a>
          </div>
        </div>
        <a class="navbar-item" href="../../docs/about.html">
          <span class="icon">
            <img src="../../_/img/home.png"></img>
          </span>
        </a>
      </div>
    </div>
  </nav>
</header>
<div class="body ">
<div class="nav-container" data-component="userguide" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../about.html">User Guide</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../fun/about.html">Fundamentals</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../fun/core-concepts.html">Core Concepts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../fun/building-blocks.html">Building Blocks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../fun/programming-model.html">Programming Model</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../fun/ui-hints.html">UI Hints</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../fun/crud.html">CRUD</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../fun/business-rules.html">Business Rules</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../fun/drop-downs-and-defaults.html">Drop downs and Defaults</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../fun/available-domain-services.html">Available Domain Services</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="about.html">Beyond the Basics</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="i18n.html">i18n</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="headless-access.html">Headless Access</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="hints-and-tips.html">Hints-n-Tips</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="programming-model.html">Programming Model</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="deployment.html">Deployment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="web-xml.html">web.xml</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Extensions</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../flyway/about.html">Flyway</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">User Guide</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title"> </span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">BC Mappings Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../mappings/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Committers' Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../comguide/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Contributors' Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../conguide/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Core Framework</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../core/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Extensions Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../extensions/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Incubator Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../incubator/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">JDO/DataNucleus</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../pjdo/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Legacy Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../legacy/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Reference Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../refguide/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Release Notes</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../relnotes/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Restful Objects Viewer</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../vro/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Security Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../security/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Setup Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../setupguide/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Subdomains Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../subdomains/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Testing Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../testing/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">User Guide</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Value Types Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../valuetypes/about.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Wicket Viewer</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../vw/about.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main role="main">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../docs/about.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../about.html">User Guide</a></li>
    <li><a href="about.html">Beyond the Basics</a></li>
    <li><a href="deployment.html">Deployment</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/apache/isis/edit/HEAD/api/adoc/userguide/modules/btb/pages/deployment.adoc">Edit</a></div>
</div>
<article class="doc">
    <a name="section-top"></a>
<h1 class="page">Deployment</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This chapter provides guidance on some common deployment scenarios.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cmd-line"><a class="anchor" href="#cmd-line"></a>Command Line (<code>WebServer</code>)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>TODO: this is out-of-date, can instead use Spring container.</p>
</div>
<div class="paragraph">
<p>As well as deploying an Apache Isis application into a servlet container, it is also possible to invoke from the command line using the <code>org.apache.isis.WebServer</code> utility class.
This is especially useful while developing and testing, but may also suit some deployment scenarios (eg running as a standalone EXE within a Docker container, for example).
Internally the <code>WebServer</code> spins up a Jetty servlet container.</p>
</div>
<div class="paragraph">
<p>The class also supports a number of command line arguments:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Command line args for <code>org.apache.isis.Webserver</code></caption>
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 22.2222%;">
<col style="width: 22.2222%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Flag</th>
<th class="tableblock halign-left valign-top">Long format</th>
<th class="tableblock halign-left valign-top">Values<br>
(default)</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>-t</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>--type</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>server_prototype</code>, <code>server</code><br>
(<code>server</code>)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Deployment type</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>-m</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>--manifest</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>FQCN</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Fully qualified class name of the <a href="../../refguide/applib-cm/classes/super.html#AppManifest" class="page"><code>AppManifest</code></a> to use to bootstrap the system.<br></p>
</div>
<div class="paragraph">
<p>This flag sets/overrides the <code>isis.appManifest</code> configuration property to the specified class name.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>-f</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>--fixture</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>FQCN</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Fully qualified class name of the fixture (extending <a href="../../refguide/applib-cm/classes/super.html#FixtureScript" class="page"><code>FixtureScript</code></a>) to be run to setup data.<br></p>
</div>
<div class="paragraph">
<p>This flag sets/overrides the <code>isis.fixtures</code> configuration property to the specified class name, and also sets the <code>isis.persistor.datanucleus.install-fixtures</code> configuration property to <code>true</code> to instruct the JDO/DataNucleus objectstore to actually load in the fixtures.<br></p>
</div>
<div class="paragraph">
<p>It is also possible to specify the fixture class name using either the <code>$IsisFixture</code> or <code>$IsisFixtures</code> environment variable (case insensitive).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>-p</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>--port</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>(8080)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The port number to listen on.<br></p>
</div>
<div class="paragraph">
<p>This flag sets/overrides the <code>isis.embedded-web-server.port</code> configuration property.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>-c</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>--config</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>filename</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>configuration file containing additional configuration properties</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>-D</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>xxx=yyy</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specify additional arbitrary configuration properties.  This can be specified multiple times.<br></p>
</div>
<div class="paragraph">
<p>Further discussion below.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>-v</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>--version</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Prints the version, then quits</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>-h</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>--help</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Prints a usage message, then quits</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note that the <code>-D</code> argument is <strong>not</strong> a system property, it is parsed by <code>WebServer</code> itself.  That said, it is <em>also</em> possible to specify system properties, and these will also be processed in the exact same way.<br></p>
</div>
<div class="paragraph">
<p>Said another way, properties can be specified either as application arguments:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ini hljs" data-lang="ini">java org.apache.isis.WebServer -Dxxx=yyy -Daaa=bbb</code></pre>
</div>
</div>
<div class="paragraph">
<p>or as system properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ini hljs" data-lang="ini">java -Dxxx=yyy -Daaa=bbb org.apache.isis.WebServer</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">The <code>Dummy</code> class</div>
<div class="paragraph">
<p>The framework also provides the <code>org.apache.isis.Dummy</code> class, which consists of a single empty <code>main(String[])</code> method.  It was introduced as a convenience for developers using Eclipse in combination with the DataNucleus plugin; if used as a launch target then it allow the entities to be enhanced withouth the running an app.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="externalized-configuration"><a class="anchor" href="#externalized-configuration"></a>Externalized Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As described <a href="#refguide:config:configuration-files.adoc" class="page unresolved">here</a>, by default Apache Isis itself bootstraps from the
<code>isis.properties</code> configuration file.
It will also read configuration from the (optional) component/implementation-specific configuration files (such as <code>persistor_datanucleus.properties</code> or <code>viewer_wicket.properties</code>), and also (optional) component-specific configuration files (such as <code>persistor.properties</code> or <code>viewer.properties</code>).</p>
</div>
<div class="paragraph">
<p>It&#8217;s generally not good practice to have the same configuration property in more than one file, but if that does occur, then the subsequent configuration property will be ignored.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In addition the framework will also load the <code>overrides.properties</code> file.
This is intended to support deployment through Docker, as discussed <a href="about.html#docker" class="page">next</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All of these files are read from the <code>WEB-INF</code> directory.
Having this configuration "baked into" the application is okay in a development environment, but when the app needs to be deployed to a test or production environment, this configuration should be read from an external location.</p>
</div>
<div class="paragraph">
<p>There are in fact several frameworks involved here, all of which need to be pointed to this external location:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Apache Isis itself, which (as already discussed) reads <code>isis.properties</code> and optional component-specific config files.</p>
</li>
<li>
<p><a href="http://shiro.apache.org">Apache Shiro</a>,  which reads the <code>shiro.ini</code> file (and may read other files referenced from that file)</p>
</li>
<li>
<p><a href="http://logging.apache.org/log4j/1.2">Apache log4j 1.2</a>, for logging, which reads <code>logging.properties</code> file</p>
</li>
<li>
<p>although not used by Apache Isis, there&#8217;s a good chance you may be using the Spring framework (eg if using <a href="http://activemq.apache.org">Apache Active MQ</a> or <a href="http://camel.apache.org">Apache Camel</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each of these frameworks has its own way of externalizing its configuration.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Subsequent sections explain how to externalize configuration for <a href="about.html#docker" class="page">Docker</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="apache-isis-config"><a class="anchor" href="#apache-isis-config"></a>Apache Isis' Config</h3>
<div class="paragraph">
<p>To tell Apache Isis to load configuration from an external directory, specify the <code>isis.config.dir</code> context parameter.</p>
</div>
<div class="paragraph">
<p>If the external configuration directory is fixed for all environments (systest, UAT, prod etc), then you can specify within the <code>web.xml</code> itself:</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
TODO: v2: this has almost certainly changed, because the configuration is picked up earlier; this probably no longer works.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;context-param&gt;
    &lt;param-name&gt;isis.config.dir&lt;/param-name&gt;
    &lt;param-value&gt;location of external config directory&lt;/param-value&gt;
&lt;/context-param&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If however the configuration directory varies by environment, then the context parameter will be specified to each installation of your servlet container.
Most (if not all) servlet containers will provide a means to define context parameters through proprietary config files.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that running the app using Apache Isis' <code>org.apache.isis.WebServer</code> bootstrapper does not use externalized Apache Isis configuration.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="shiro-config"><a class="anchor" href="#shiro-config"></a>Shiro Config</h3>
<div class="paragraph">
<p>If using Apache Isis' <a href="#security:shiro:configuring-isis-to-use-shiro.adoc" class="page unresolved">Shiro integration</a> for authentication and/or authorization, note that it reads from the <code>shiro.ini</code> configuration file.
By default this also resides in <code>WEB-INF</code>.</p>
</div>
<div class="paragraph">
<p>Similar to Apache Isis, Shiro lets this configuration directory be altered, by specifying the <code>shiroConfigLocations</code> context parameter.</p>
</div>
<div class="paragraph">
<p>You can therefore override the default location using the same technique as described above for Apache Isis' <code>isis.config.dir</code> context parameter.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;Parameter name="shiroConfigLocations"
           value="file:/usr/local/myapp/conf/shiro.ini"
           override="false" /&gt;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that Shiro is more flexible than Apache Isis; it will read its configuration from any URL, not just a directory on the local filesystem.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="log4j-config"><a class="anchor" href="#log4j-config"></a>Log4j Config</h3>
<div class="paragraph">
<p>By default Apache Isis configures log4j to read the <code>logging.properties</code> file in the <code>WEB-INF</code> directory.
This can be overridden by setting the <code>log4j.properties</code> system property to the URL of the log4j properties file.</p>
</div>
<div class="sect3">
<h4 id="log4j-config-tomcat"><a class="anchor" href="#log4j-config-tomcat"></a>Tomcat</h4>
<div class="paragraph">
<p>For example, if deploying to Tomcat7 or Tomcat8, this amounts to adding the following to the <code>CATALINA_OPTS</code> flags:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export CATALINA_OPTS="-Dlog4j.configuration=/usr/local/tomcat/myapp/conf/logging.properties"</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>CATALINA_OPTS</code> was called <code>TOMCAT_OPTS</code> in earlier versions of Tomcat.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Further details an be found in the <a href="https://logging.apache.org/log4j/1.2/manual.html#Example_Configurations">log4j documentation</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="spring-config"><a class="anchor" href="#spring-config"></a>Spring Config</h3>
<div class="paragraph">
<p>Although Apache Isis does not use Spring, it&#8217;s possible that your app may use other components that do use Spring.
For example, the (non-ASF) <a href="https://platform.incode.org" target="_blank" rel="noopener">Incode Platform</a>'s publishmq module uses ActiveMQ and Camel to support publishing; both of these leverage Spring.</p>
</div>
<div class="paragraph">
<p>There are several ways to externalized Spring config, but the mechanism described here is similar in nature to those that we use for externalizing Apache Isis' and Shiro&#8217;s configuration.
In your <code>web.xml</code>, you will probably load the Spring application context using code such as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;listener&gt;
    &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;
&lt;/listener&gt;
&lt;context-param&gt;
    &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
    &lt;param-value&gt;
        classpath:my-application-context-config.xml
    &lt;/param-value&gt;
&lt;/context-param&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add a new application context <code>propertyPlaceholderConfigurer-config.xml</code> defining a <code>PropertyPlaceholderConfigurer</code> bean.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;beans
  xmlns="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
  http://activemq.apache.org/schema/core http://activemq.apache.org/schema/core/activemq-core.xsd"&gt;
    &lt;bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"&gt;
        &lt;property name="locations"&gt;
            &lt;list&gt;
                &lt;value&gt;${spring.config.file}&lt;/value&gt;
            &lt;/list&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This reads the properties from a <code>spring.config.file</code>, defined as a context-param in the <code>web.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;context-param&gt;
    &lt;param-name&gt;spring.config.file&lt;/param-name&gt;
    &lt;param-value&gt;classpath:spring.properties&lt;/param-value&gt;
&lt;/context-param&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then update the bootstrapping in <code>web.xml</code> to use this new application context, eg:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;context-param&gt;
    &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
    &lt;param-value&gt;
        classpath:my-application-context-config.xml,
        classpath:propertyPlaceholderConfigurer-config.xml
    &lt;/param-value&gt;
&lt;/context-param&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To use some other externalized configuration, override the <code>spring.config.file</code> property, eg using Tomcat&#8217;s config file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;Parameter name="spring.config.dir"
           value="file:/usr/local/myapp/conf/spring.properties"
           override="false" /&gt;</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="an-alternative-approach"><a class="anchor" href="#an-alternative-approach"></a>An alternative approach</h4>
<div class="paragraph">
<p>As mentioned, there are several other ways to externalize Spring&#8217;s config; one approach is to use Spring&#8217;s profile support.</p>
</div>
<div class="paragraph">
<p>For example, in the application context you could have:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;beans profile="default"&gt;
    &lt;bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"&gt;
        &lt;property name="locations"&gt;
            &lt;list&gt;
                &lt;value&gt;classpath:dev.properties&lt;/value&gt;
            &lt;/list&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;
&lt;beans profile="externalized"&gt;
    &lt;bean id="propertyPlaceHolder" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"&gt;
        &lt;property name="locations"&gt;
            &lt;list&gt;
                &lt;value&gt;classpath:prod.properties&lt;/value&gt;
            &lt;/list&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
&lt;/beans&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The idea being that specifying the "prod" profile rather than the "default" profile would cause a different set of configuration properties to be read.</p>
</div>
<div class="paragraph">
<p>The active profile can be overridden with a system property, eg:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">-Dspring.profiles.active=prod</code></pre>
</div>
</div>
<div class="paragraph">
<p>take a look at <a href="http://stackoverflow.com/a/10041835/56880">this SO answer</a> on using Spring profiles.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="jvm-args"><a class="anchor" href="#jvm-args"></a>JVM Args</h3>
<div class="paragraph">
<p>The <a href="../../refguide/applib-svc/WrapperFactory.html" class="page"><code>WrapperFactory</code></a> uses <a href="http://www.javassist.org">Javassist</a> to create on-the-fly classes acting as a proxy.
The cost of these proxies can be mitigated using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ini hljs" data-lang="ini">-XX:+CMSClassUnloadingEnabled -XX:+UseConcMarkSweepGC</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="using-a-jndi-datasource"><a class="anchor" href="#using-a-jndi-datasource"></a>Using a JNDI Datasource</h3>
<div class="paragraph">
<p>See the guidance in the <a href="../../pjdo/configuring.html#using-jndi-data-source" class="page">configuring datanucleus</a> section.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tomcat"><a class="anchor" href="#tomcat"></a>Deploying to Tomcat</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Some pointers on how to <a href="about.html#externalized-configuration" class="page">externalize configuration</a> when deploying to Tomcat.
Other servlet containers have similar mechanisms.</p>
</div>
<div class="sect2">
<h3 id="tomcat-8-0"><a class="anchor" href="#tomcat-8-0"></a>Tomcat 8.0</h3>
<div class="paragraph">
<p>If deploying Tomcat 8.0, create a file called <code>$TOMCAT_HOME/conf/Catalina/localhost/todoapp.xml</code>, where <code>todoapp.xml</code> corresponds to the name of the webapp being deployed, eg <code>todoapp.war</code>.</p>
</div>
<div class="paragraph">
<p>The contents of this file would be something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;Context&gt;

    &lt;WatchedResource&gt;WEB-INF/web.xml&lt;/WatchedResource&gt;
    &lt;Manager pathname="" /&gt;

    &lt;Parameter name="shiroConfigLocations"
               value="file:/var/todoapp/dev/shiro.ini"
               override="false" /&gt;

    &lt;Parameter name="isis.config.dir"
               value="/var/todoapp/dev/"
               override="false" /&gt;

    &lt;Parameter name="spring.config.file"
               value="file:/var/todoapp/dev/spring.properties"
               override="false" /&gt;

    &lt;Parameter name="wicket.configuration"
               value="development"
               override="false" /&gt;

&lt;/Context&gt;</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that the <code>override</code> key should be set to "false", not "true".
It indicates whether the application&#8217;s own <code>web.xml</code> can override the setting.
In most cases, you probably want to disallow that.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Thus, when <code>todoapp.war</code> is deployed to <code>$CATALINA_HOME/webapp</code>, then this configuration will be used.</p>
</div>
<div class="paragraph">
<p>For more detail, see the Tomcat 8.0 documentation on <a href="http://tomcat.apache.org/tomcat-8.0-doc/config/context.html#Defining_a_context">defining a context</a> and on <a href="http://tomcat.apache.org/tomcat-8.0-doc/config/context.html#Context_Parameters">context parameters</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="tomcat-7-0"><a class="anchor" href="#tomcat-7-0"></a>Tomcat 7.0</h3>
<div class="paragraph">
<p>If using Tomcat 7.0, the process is similar to that of Tomcat 8.0, however the override file resides in <code>$TOMCAT_HOME/conf</code>, rather than <code>$TOMCAT_HOME/conf/Catalina/localhost</code>.</p>
</div>
<div class="paragraph">
<p>For more detail, see the Tomcat 7.0 documentation on <a href="http://tomcat.apache.org/tomcat-7.0-doc/config/context.html#Defining_a_context">defining a context</a> and on <a href="http://tomcat.apache.org/tomcat-7.0-doc/config/context.html#Context_Parameters">context parameters</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="docker"><a class="anchor" href="#docker"></a>Docker</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When running the application within a Docker container, the problem that must be solved is to override the
configuration properties baked into the war file, eg to point to the app to a different JDBC URL.</p>
</div>
<div class="paragraph">
<p>There are several options.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>All the options here rely on starting the Docker container with a set of arguments, some of which would very likely
be passwords for database connections etc.  As such these techniques are only suitable where the security of the
Docker host can be assured.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="using-an-overrides-properties"><a class="anchor" href="#using-an-overrides-properties"></a>Using an <code>overrides.properties</code></h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
TODO: v2: this is out of date; instead just cross-reference Spring docs on how to do this.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In addition to loading the regular configuration properties from <code>WEB-INF</code> directory (described
<a href="#refguide:config:configuration-files.adoc" class="page unresolved">here</a>), Apache Isis will also load the <code>overrides.properties</code> file.</p>
</div>
<div class="paragraph">
<p>This file is treated slightly differently than the other configuration files; it is loaded last, and any configuration
properties defined in it will <em>override</em> any configuration properties already read from other files (this includes
any properties specified via the command line).</p>
</div>
<div class="paragraph">
<p>While the regular configuration files are "baked into" the application WAR file, the <code>overrides.properties</code> file is
created dynamically as part of the Docker <code>ENTRYPOINT</code> script, eg as documented in the
<a href="https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/">Dockerfile best practices</a>.</p>
</div>
<div class="paragraph">
<p>Thus, Docker can be supported as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>use <code>mvn</code> (as currently) to create a WAR file; set up with the <code>pom.xml</code> with the JDBC drivers of all DB servers that
you might want to connect to (hsqldb, sql server, postgresql etc)</p>
</li>
<li>
<p>in the <code>Dockerfile</code>, specify a base image containing Tomcat 8 + Java 8 (say)</p>
</li>
<li>
<p>also in the <code>Dockerfile</code>, arrange it such that the WAR file is "exploded" (there is no need to copy over the WAR file itself)</p>
</li>
<li>
<p>write a script that:</p>
<div class="ulist">
<ul>
<li>
<p>explodes the WAR file, copying it into the Tomcat&#8217;s <code>webapp</code> directory.  There is no need to copy
over the WAR file itself.</p>
</li>
<li>
<p>creates the <code>overrides.properties</code> file from any input arguments, placing it into the <code>WEB-INF</code> directory</p>
</li>
<li>
<p>sets all files to read-only</p>
</li>
</ul>
</div>
</li>
<li>
<p>use <code>ENTRYPOINT</code> (and probably also <code>CMD</code>) to invoke above script.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="using-system-properties"><a class="anchor" href="#using-system-properties"></a>Using system properties</h3>
<div class="paragraph">
<p>The servlet context initializer will search for any system properties called <code>isis.xxx</code>
 and if present will use them as overrides.</p>
</div>
<div class="paragraph">
<p>Thus, an alternative option for a Docker image is to bootstrap the servlet container (Tomcat, Jetty) with appropriate
system properties set up.  For example, with Tomcat this can be done by writing into the <code>conf/catalina.properties</code> file
(see for example <a href="http://stackoverflow.com/a/16566920">this stackoverflow</a> post).</p>
</div>
<div class="paragraph">
<p>The Docker&#8217;s <code>ENTRYPOINT</code> therefore just needs to parse the Docker container&#8217;s own command line arguments and use to
create this file.</p>
</div>
</div>
<div class="sect2">
<h3 id="using-isis_opts"><a class="anchor" href="#using-isis_opts"></a>Using <code>$ISIS_OPTS</code></h3>
<div class="paragraph">
<p>The servlet context initializer will search for an environment variable called <code>$ISIS_OPTS</code>
 and if present will parse the content as a set of key/value pairs.  Each key/value pair is separated by "||".</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export ISIS_OPTS="isis.appManifest=domainapp.app.DomainAppAppManifestWithFixtures||isis.objects.editing=false"</code></pre>
</div>
</div>
<div class="paragraph">
<p>can be used to run with a different app manifest, and also to disable editing of properties.</p>
</div>
<div class="paragraph">
<p>To use a different separator, set the (optional) <code>$ISIS_OPTS_SEPARATOR</code> variable.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export ISIS_OPTS_SEPARATOR=";"
export ISIS_OPTS="isis.appManifest=domainapp.app.DomainAppAppManifestWithFixtures;isis.objects.editing=false"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Docker&#8217;s <code>ENTRYPOINT</code> therefore just needs to parse the Docker container&#8217;s own command line arguments and use to
set this environment variable.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="gae"><a class="anchor" href="#gae"></a>Deploying to Google App Engine</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <a href="https://cloud.google.com/appengine/docs">Google App Engine</a> (GAE) provides a JDO API, meaning that you can deploy Apache Isis onto GAE using JDO/DataNucleus.</p>
</div>
<div class="paragraph">
<p>However, GAE is not an RDBMS, and so there are some limitations that it imposes. This page gathers together various hints, tips and workarounds.</p>
</div>
<div class="sect2">
<h3 id="primary-keys-and-ownedunowned-relationships"><a class="anchor" href="#primary-keys-and-ownedunowned-relationships"></a>Primary Keys and Owned/Unowned Relationships</h3>
<div class="paragraph">
<p>All entities must have a <code>@PrimaryKey</code>. Within GAE, the type of this key matters.</p>
</div>
<div class="paragraph">
<p>For an entity to be an aggregate root, (ie a root of an GAE entity group), its key must be a <code>Long</code>, eg:</p>
</div>
<div class="paragraph">
<p>Any collection that holds this entity type (eg <code>ToDoItem#dependencies</code> holding a collection of <code>ToDoItem</code>s) should then be annotated with <code>@Unowned</code> (a GAE annotation).</p>
</div>
<div class="paragraph">
<p>If on the other hand you want the object to be owned (through a 1:m relationship somewhere) by some other root, then use a String:</p>
</div>
<div class="paragraph">
<p>Note: if you store a relationship with a String key it means that the parent object <em>owns</em> the child, any attempt to change the relationship raise and exception.</p>
</div>
</div>
<div class="sect2">
<h3 id="custom-types"><a class="anchor" href="#custom-types"></a>Custom Types</h3>
<div class="paragraph">
<p>Currently Apache Isis' <code>Blob</code> and <code>Clob</code> types and the JODA types (<code>LocalDate</code> et al) are <em>not</em> supported in GAE.</p>
</div>
<div class="paragraph">
<p>Instead, GAE defines a <a href="https://cloud.google.com/appengine/docs/java/datastore/entities#Properties_and_Value_Types">fixed set of value types</a>, including <code>BlobKey</code>. Members of the Apache Isis community have this working, though I haven&#8217;t seen the code.</p>
</div>
<div class="paragraph">
<p>The above notwithstanding, Andy Jefferson at DataNucleus tells us:</p>
</div>
<div class="paragraph">
<p><div class="extended-quote-first"><p>GAE JDO/JPA does support <em>some</em> type conversion, because looking at <a href="http://code.google.com/p/datanucleus-appengine/source/browse/trunk/src/com/google/appengine/datanucleus/StoreFieldManager.java#349">StoreFieldManager.java</a> for any field that is Object-based and not a relation nor Serialized it will call <a href="http://code.google.com/p/datanucleus-appengine/source/browse/trunk/src/com/google/appengine/datanucleus/TypeConversionUtils.java#736">TypeConverstionUtils.java</a> and that looks for a <code>TypeConverter</code> (specify <code>@Extension</code> with key of "type-converter-name" against a field and value as the <code>TypeConverter</code> class) and it should convert it. Similarly when getting the value from the datastore.
</p></div></p>
</div>
<div class="paragraph">
<p>On further investigation, it seems that the GAE implementation performs a type check on a <code>SUPPORTED_TYPES</code> Java set, in <code>com.google.appengine.api.datastore.DataTypeUtils</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">if (!supportedTypes.contains(value.getClass())) {
    throw new IllegalArgumentException(prefix + value.getClass().getName() + " is not a supported property type.");
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We still need to try out Andy&#8217;s recipe, above.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="neo4j"><a class="anchor" href="#neo4j"></a>Neo4J</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Apache Isis has experimental support for Neo4J, courtesy of DataNucleus' <a href="http://www.datanucleus.org/products/datanucleus/datastores/neo4j.html">Neo4J Datastore</a> implementation.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <a href="http://github.com/apache/isis-app-neoapp">neoapp</a> is configured to run with an embedded Neo4J server running alongside the Apache Isis webapp.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The steps below describe the configuration steps required to update an existing app.</p>
</div>
<div class="sect2">
<h3 id="connectionurl"><a class="anchor" href="#connectionurl"></a>ConnectionURL</h3>
<div class="paragraph">
<p>In <code>persistor.properties</code>, update the JDO <code>ConnectionURL</code> property, eg:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ini hljs" data-lang="ini">isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionURL=neo4j:neo4j_DB</code></pre>
</div>
</div>
<div class="paragraph">
<p>The other connection properties (<code>ConnectionDriverName</code>, <code>ConnectionUserName</code> and <code>ConnectionPassword</code>) should be commented out.</p>
</div>
</div>
<div class="sect2">
<h3 id="update-pom-xml"><a class="anchor" href="#update-pom-xml"></a>Update pom.xml</h3>
<div class="paragraph">
<p>Add the following dependency to the <code>webapp</code> project&#8217;s <code>pom.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependencies&gt;
    ...
    &lt;dependency&gt;
        &lt;groupId&gt;org.datanucleus&lt;/groupId&gt;
        &lt;artifactId&gt;datanucleus-neo4j&lt;/artifactId&gt;
        &lt;version&gt;4.0.5&lt;/version&gt;                    <i class="conum" data-value="1"></i><b>(1)</b>
    &lt;/dependency&gt;
    ...
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>for Isis v1.9.0, use the value shown.
For Isis v1.8.0, use 3.2.3.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jvm-flags"><a class="anchor" href="#jvm-flags"></a>JVM Flags</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
FIXME
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The default JVM configuration will most likely not be appropriate for running Isis as a webapp.  The table below suggests some JVM args that you will probably want to modify:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. JVM args</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Flag</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Run the JVM in server mode, meaning that the JVM should spend more time on the optimization of the fragments of codes that are most often used (hotspots). This leads to better performance at the price of a higher overhead at startup.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-Xms128m
Minimum heap size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-Xmx768m</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum heap size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-XX:PermSize=64m</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minimum perm size (for class definitions)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-XX:MaxPermSize=256m</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum perm size (for class definitions)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-XX:+DisableExplicitGC</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>There are also a whole bunch of GC-related flags, that you might want to explore; see this detailed <a href="http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html">Hotspot JVM</a> documentation and also this <a href="http://blog.ragozin.info/2011/09/hotspot-jvm-garbage-collection-options.html">blog post</a>.</p>
</div>
<div class="sect2">
<h3 id="configuring-in-tomcat"><a class="anchor" href="#configuring-in-tomcat"></a>Configuring in Tomcat</h3>
<div class="paragraph">
<p>If using Tomcat, update the <code>CATALINA_OPTS</code> variable.  (This variable is also updated if <a href="deployment/externalized-configuration.html#log4j" class="page">configuring logging to run externally</a>).</p>
</div>
</div>
</div>
</div>
</article>
<aside class="article-aside toc" role="navigation">
    <p class="toc-title">On this page</p>
    <div id="article-toc"></div>
</aside>
</main>
</div>
<footer class="footer">
    <div class="content">
        <div class="copyright">
            <p>
                Copyright  2010~2019 The Apache Software Foundation, licensed under the Apache License, v2.0.
                <br/>
                Apache, the Apache feather logo, Apache Isis, and the Apache Isis project logo are all trademarks of The Apache Software Foundation.
            </p>
        </div>
        <div class="revision">
            <p>Revision: 2.0.0-M2.20200226-0400-676cfbe6</p>
        </div>
    </div>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script src="../../_/js/vendor/jquery-3.4.1.min.js"></script>
<script src="../../_/js/vendor/jquery-ui-1.12.1.custom.widget-only.min.js"></script>
<script src="../../_/js/vendor/jquery.tocify.min.js"></script>

<script>
    $(function() {
        $("#article-toc").tocify( {
            showEffect: "slideDown",
            hashGenerator: "pretty",
            hideEffect: "slideUp",
            selectors: "h2, h3",
            scrollTo: 120,
            smoothScroll: true,
            theme: "jqueryui",
            highlightOnScroll: true
        } );
    });
</script>
  </body>
</html>
