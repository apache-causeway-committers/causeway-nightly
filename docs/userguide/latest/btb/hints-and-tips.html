<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hints and Tips :: Apache Isis</title>
    <meta name="generator" content="Antora 2.3.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="stylesheet" href="../../../_/css/site-custom.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i|Raleway:300,400,500,700,800|Montserrat:300,400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"/>
<link rel="home" href="../../.." title="Apache Isis">
  <link rel="next" href="programming-model.html" title="Programming Model">
  <link rel="prev" href="headless-access.html" title="Headless Access">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../..">
          <span class="icon">
            <img src="../../../_/img/isis-logo-48x48.png"></img>
          </span>
        <span>Apache Isis</span>
      </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <a class="navbar-end">
        <div class="navbar-item hide-for-print">
          <span>
            <input id="algolia-search-input" placeholder="Search"></span>
          </span>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Quick Start</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Starter Apps</span>
            <a class="navbar-item" href="../../../docs/2.0.0-M5/starters/helloworld.html">Hello World</a>
            <a class="navbar-item" href="../../../docs/2.0.0-M5/starters/simpleapp.html">Simple App</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Demos &amp; Tutorials</span>
            <a class="navbar-item" href="../../../docs/2.0.0-M5/demo/about.html">Demo App</a>
            <a class="navbar-item" href="https://danhaywood.gitlab.io/isis-petclinic-tutorial-docs/petclinic/1.16.2/intro.html">Petclinic (tutorial)</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Resources</span>
            <a class="navbar-item" href="../../../docs/2.0.0-M5/resources/cheatsheet.html">Cheatsheet</a>
            <a class="navbar-item" href="../../../docs/2.0.0-M5/resources/icons.html">Icons</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Guides</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Development</span>
            <a class="navbar-item" href="../../../setupguide/2.0.0-M5/about.html">Setup Guide</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Core</span>
            <a class="navbar-item" href="../../../userguide/2.0.0-M5/about.html">User Guide</a>
            <a class="navbar-item" href="../../../refguide/2.0.0-M5/about.html">Reference Guide</a>
            <a class="navbar-item" href="../../../testing/2.0.0-M5/about.html">Testing Guide</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Libraries</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">For Use in Apps</span>
            <a class="navbar-item" href="../../../subdomains/2.0.0-M5/about.html">Subdomain Libraries</a>
            <a class="navbar-item" href="../../../valuetypes/2.0.0-M5/about.html">Value Types</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Integrate between Apps</span>
            <a class="navbar-item" href="../../../mappings/2.0.0-M5/about.html">Bounded Context Mapping Libraries</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Other</span>
            <a class="navbar-item" href="../../../incubator/2.0.0-M5/about.html">Incubator</a>
            <a class="navbar-item" href="../../../legacy/2.0.0-M5/about.html">Legacy</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Components</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Viewers</span>
            <a class="navbar-item" href="../../../vw/2.0.0-M5/about.html">Wicket UI</a>
            <a class="navbar-item" href="../../../vro/2.0.0-M5/about.html">Restful Objects (REST)</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Security</span>
            <a class="navbar-item" href="../../../security/2.0.0-M5/about.html">Security Guide</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Persistence</span>
            <a class="navbar-item" href="../../../pjdo/2.0.0-M5/about.html">DataNucleus (JDO)</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Extensions</span>
            <a class="navbar-item" href="../../../extensions/2.0.0-M5/about.html">Extensions Catalog</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Support</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Contact</span>
            <a class="navbar-item" href="../../../docs/2.0.0-M5/support/slack-channel.html">Slack</a>
            <a class="navbar-item" href="../../../docs/2.0.0-M5/support/mailing-list.html">Mailing Lists</a>
            <a class="navbar-item" href="https://issues.apache.org/jira/browse/ISIS">JIRA</a>
            <a class="navbar-item" href="https://stackoverflow.com/questions/tagged/isis">Stack Overflow</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Releases</span>
            <a class="navbar-item" href="../../../docs/2.0.0-M5/downloads/how-to.html">Downloads</a>
            <a class="navbar-item" href="../../../relnotes/2.0.0-M5/about.html">Release Notes</a>
            <a class="navbar-item" href="../../../docs/2.0.0-M5/archive/1-x.html">Archive (1.x)</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Framework</span>
            <a class="navbar-item" href="../../../conguide/2.0.0-M5/about.html">Contributors' Guide</a>
            <a class="navbar-item" href="../../../comguide/2.0.0-M5/about.html">Committers' Guide</a>
            <a class="navbar-item" href="../../../core/2.0.0-M5/about.html">Core Design</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">ASF</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="http://www.apache.org/">Apache Homepage</a>
            <a class="navbar-item" href="https://www.apache.org/events/current-event">Events</a>
            <a class="navbar-item" href="https://www.apache.org/licenses/">Licenses</a>
            <a class="navbar-item" href="https://www.apache.org/security/">Security</a>
            <a class="navbar-item" href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a>
            <a class="navbar-item" href="https://www.apache.org/foundation/thanks.html">Thanks</a>
            <hr class="navbar-divider"/>
            <a class="navbar-item" href="https://whimsy.apache.org/board/minutes/Isis.html">PMC board minutes</a>
          </div>
        </div>
        <a class="navbar-item" href="../../../docs/2.0.0-M5/about.html">
          <span class="icon">
            <img src="../../../_/img/home.png"></img>
          </span>
        </a>
      </div>
    </div>
  </nav>
</header>
<div class="body ">
<div class="nav-container" data-component="userguide" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-pagination">
  <a class="page-previous" rel="prev" href="headless-access.html" title="Headless Access"><span></span></a>
  <a class="page-next" rel="next"
     href="programming-model.html" title="Programming Model"><span></span></a>
<!--
page.parent doesn't seem to be set...
  <a class="page-parent" rel="prev" href="about.html" title="Headless Access"><span></span></a>
-->
</div>
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../about.html">User Guide</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../fun/concepts-patterns.html">Concepts &amp; Patterns</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../fun/overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../fun/domain-entities-and-services.html">Domain Entities &amp; Services</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../fun/object-members.html">Object Members</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../fun/ui.html">UI Layout &amp; Hints</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../fun/business-rules.html">Business Rules</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../fun/drop-downs-and-defaults.html">Drop downs and Defaults</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../fun/meta-annotations.html">Meta-annotations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../fun/view-models.html">View Models</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../fun/mixins.html">Mixins</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../fun/modules.html">Modules</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="about.html">Beyond the Basics</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="i18n.html">i18n</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="headless-access.html">Headless Access</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="hints-and-tips.html">Hints-n-Tips</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="programming-model.html">Programming Model</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Extensions</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../flyway/about.html">Flyway</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../quartz/about.html">Quartz</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">User Guide</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title"> </span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../docs/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">BC Mappings Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../mappings/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Committers' Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../comguide/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Contributors' Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../conguide/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Design Docs</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../core/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Extensions Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../extensions/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Incubator Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../incubator/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">JDO/DataNucleus</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../pjdo/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Legacy Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../legacy/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Reference Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../refguide/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Release Notes</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../relnotes/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Restful Objects Viewer</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../vro/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Security Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../security/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Setup Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../setupguide/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Subdomains Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../subdomains/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">System Overview</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../system/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Testing Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../testing/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">User Guide</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Value Types Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../valuetypes/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Wicket Viewer</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../vw/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main role="main">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../docs/latest/about.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../about.html">User Guide</a></li>
    <li><a href="about.html">Beyond the Basics</a></li>
    <li><a href="hints-and-tips.html">Hints-n-Tips</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/apache/isis/edit/master/api/adoc/userguide/modules/btb/pages/hints-and-tips.adoc">Edit</a></div>
</div>
<article class="doc">
    <a name="section-top"></a>
<h1 class="page">Hints and Tips</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This chapter provides some solutions for problems we&#8217;ve encountered ourselves or have been raised on the Apache Isis mailing lists.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="are-you-sure"><a class="anchor" href="#are-you-sure"></a>'Are you sure?' idiom</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sometimes an action might perform irreversible changes.
In such a case it&#8217;s probably a good idea for the UI to require that the end-user explicitly confirms that they intended to invoke the action.</p>
</div>
<div class="paragraph">
<p>One way to meet this requirement is using the framework&#8217;s built-in <a href="../../../refguide/latest/applib-ant/Action.html#semantics" class="page"><code>@Action#semantics</code></a> attribute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Action(
        semantics = SemanticsOf.IDEMPOTENT_ARE_YOU_SURE
)
public SimpleObject updateName(
        @Parameter(maxLength = NAME_LENGTH)
        @ParameterLayout(named = "New name")
        final String name) {
    setName(name);
    return this;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will render as:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/hints-and-tips/action-semantics-are-you-sure.png" alt="action semantics are you sure">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="custom-css"><a class="anchor" href="#custom-css"></a>Custom CSS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Custom CSS styles can be associated with specific regions of the layout:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;grid ...&gt;
    &lt;row&gt;
        &lt;col span="2" unreferencedActions="true"&gt;
            &lt;ns2:domainObject/&gt;
            &lt;row&gt;
                &lt;col span="12"
                     cssClass="custom-width-100"&gt;       <i class="conum" data-value="1"></i><b>(1)</b>
                    &lt;ns2:action id="exportToWordDoc"/&gt;
                &lt;/col&gt;
            &lt;/row&gt;
            ...
        &lt;/col&gt;
        &lt;col span="5" unreferencedCollections="true"
             cssClass="custom-padding-top-20"&gt;          <i class="conum" data-value="2"></i><b>(2)</b>
            ...
        &lt;/col&gt;
        &lt;col span="5"
            cssClass="custom-padding-top-20"&gt;           <i class="conum" data-value="3"></i><b>(3)</b>
            ...
        &lt;/col&gt;
    &lt;/row&gt;
&lt;/grid&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Render the column with the <code>custom-width-100</code> CSS class.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Render the column with the <code>custom-padding-top-20</code> CSS class.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Ditto</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example the <code>custom-width-100</code> style is used to "stretch" the button for the <code>exportToWordDoc</code> action in the left-most column.
For the <a href="../../../vw/latest/about.html" class="page">Wicket Viewer</a> this is accomplished with <a href="../../../refguide/latest/config/application-specific/application-css.html" class="page">custom CSS</a>, usually CSS in the <code>static/css/application.css</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-css hljs" data-lang="css">.custom-width-100 ul,
.custom-width-100 ul li,
.custom-width-100 ul li a.btn {
    width: 100%;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly, the middle and right columns are rendered using the <code>custom-padding-top-20</code> CSS class.
This shifts them down from the top of the page slightly, using the following CSS:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-css hljs" data-lang="css">.custom-padding-top-20 {
    padding-top: 20px;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="replacing-default-service-implementations"><a class="anchor" href="#replacing-default-service-implementations"></a>Overriding Default Service Implns</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The framework provides default implementations for many of the <a href="../../../refguide/latest/applib-svc/about.html" class="page">domain services</a>.
This is convenient, but sometimes you will want to replace the default implementation with your own service implementation.</p>
</div>
<div class="paragraph">
<p>For example, suppose you wanted to provide your own implementation of <a href="../../../refguide/latest/applib-svc/LocaleProvider.html" class="page"><code>LocaleProvider</code></a>.
The trick is to use the Spring <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/core/annotation/Order.html"><code>@Order</code></a> annotation or equivalent mechanism.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s how:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.springframework.stereotype.Service;
import org.springframework.core.Ordered;

@Service
@Order(OrderPrecedence.HIGH)                                <i class="conum" data-value="1"></i><b>(1)</b>
public class MyLocaleProvider implements LocaleProvider {
    @Override
    public Locale getLocale() {
        // ...
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>OrderPrecedence</code> (in the Apache Isis applib) provides some standard values.</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="decorating-existing-implementations"><a class="anchor" href="#decorating-existing-implementations"></a>Decorating existing implementations</h3>
<div class="paragraph">
<p>It&#8217;s sometimes useful to decorate the existing implementation (ie have your own implementation delegate to the default); this is quite easy to imlpement:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.springframework.stereotype.Service;
import org.springframework.core.Ordered;

@Service
@Order(OrderPrecedence.HIGHEST)                             <i class="conum" data-value="1"></i><b>(1)</b>
public class MyLocaleProvider implements LocaleProvider {

    @Inject List&lt;LocaleProvider&gt; localeProviders;           <i class="conum" data-value="2"></i><b>(2)</b>

    @Override
    public Locale getLocale() {
        return localeProviders.stream()                     <i class="conum" data-value="3"></i><b>(3)</b>
                .filter(x -&gt; x != this)                     <i class="conum" data-value="4"></i><b>(4)</b>
                .findFirst()                                <i class="conum" data-value="5"></i><b>(5)</b>
                .map(LocaleProvider::getLocale)             <i class="conum" data-value="6"></i><b>(6)</b>
                .orElseThrow(RuntimeException::new);        <i class="conum" data-value="7"></i><b>(7)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>takes precedence over the default implementation when injected elsewhere.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>injects all implementations, including this implementation</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>streams over all implementations&#8230;&#8203;</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>...ignoring this one&#8230;&#8203;</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>...uses the next one&#8230;&#8203;</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>...and delegate to it.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Fails fast if no other implementations available (should not happen if framework provides a default implementation).</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>None of the default implementations provided by the framework use <code>Ordered(OrderPrecedence.HIGHEST)</code>, so all can be overridden if required.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="transactions-and-errors"><a class="anchor" href="#transactions-and-errors"></a>Transactions and Errors</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Apache Isis, every interaction (action invocation or property edit) is automatically wrapped in a transaction, and any repository query automatically does a flush before hand.</p>
</div>
<div class="paragraph">
<p>What that means is that there&#8217;s no need to explicitly start or commit transactions in Apache Isis; this will be done for you.
Indeed, if you do try to manage transactions (eg by reaching into the JDO <code>PersistenceManager</code> exposed by the <a href="../../../pjdo/latest/services/IsisJdoSupport.html" class="page">IsisJdoSupport</a> domain service, then you are likely to confuse the framework and get a stack trace for your trouble.</p>
</div>
<div class="paragraph">
<p>However, you can complete a given transaction and start a new one.
This is sometimes useful if writing a <a href="../../../testing/latest/fixtures/about.html#fixture-scripts" class="page">fixture script</a> which is going to perform some sort of bulk migration of data from an old system.
For this use case, use the <a href="../../../refguide/latest/applib-svc/TransactionService.html" class="page"><code>TransactionService</code></a>.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class SomeLongRunningFixtureScript extends FixtureScript

    protected void execute(final ExecutionContext executionContext) {
        // do some work
        transactionService.nextTransaction();
        // do some work
        transactionService.nextTransaction();
        // do yet more work
    }

    @javax.inject.Inject
    TransactionService transactionService;
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="raise-message-in-the-ui"><a class="anchor" href="#raise-message-in-the-ui"></a>Raise message in the UI</h3>
<div class="paragraph">
<p>The framework provides the <a href="../../../refguide/latest/applib-svc/MessageService.html" class="page"><code>MessageService</code></a> as a means to return an out-of-band message to the end-user.
In the <a href="../../../vw/latest/about.html" class="page">Wicket viewer</a> these are shown as "toast" pop-ups; the
<a href="../../../vro/latest/about.html" class="page">Restful Objects viewer</a> returns an HTTP header.</p>
</div>
<div class="paragraph">
<p>The <code>UserService</code> provides three APIs, for different:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>informUser()</code> - an informational message.
In the Wicket viewer these are short-lived pop-ups that disappear after a short time.</p>
</li>
<li>
<p><code>warnUser()</code> - a warning.
In the Wicket viewer these do not auto-close; they must be acknowledged.</p>
</li>
<li>
<p><code>raiseError()</code> - an error.
In the Wicket viewer these do not auto-close; they must be acknowledged.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each pop-up has a different background colour indicating its severity.</p>
</div>
<div class="paragraph">
<p>None of these messages/errors has any influence on the transaction; any changes to objects will be committed.</p>
</div>
</div>
<div class="sect2">
<h3 id="aborting-transactions"><a class="anchor" href="#aborting-transactions"></a>Aborting transactions</h3>
<div class="paragraph">
<p>If you want to abort Apache Isis' transaction, this can be done by throwing an exception.
The exception message is displayed to the user on the error page (if <a href="../../../vw/latest/about.html" class="page">Wicket viewer</a>) or a 500 status error code (if the
<a href="../../../vro/latest/about.html" class="page">Restful Objects</a> viewer).</p>
</div>
<div class="paragraph">
<p>If the exception thrown is because of an unexpected error (eg a <code>NullPointerException</code> in the domain app itself), then the error page will include a stack trace.
If however you want to indicate that the exception is in some sense "expected", then throw a <code>RecoverableException</code> (or any subclass, eg <code>ApplicationException</code>); the stack trace will then be suppressed from the error page.</p>
</div>
<div class="paragraph">
<p>Another way in which exceptions might be considered "expected" could be as the result of attempting to persist an object which then violates some type of database constraint.
Even if the domain application checks beforehand, it could be that another user operating on the object at the same moment of time might result in the conflict.</p>
</div>
<div class="paragraph">
<p>To handle this the <a href="../../../refguide/latest/applib-svc/ExceptionRecognizerService.html" class="page"><code>ExceptionRecognizer</code></a> SPI can be used.
The framework provides a number of implementations out-of-the-box; whenever an exception is thrown it is passed to each known recognizer implementation to see if it recognizes the exception and can return a user-meaningful error message.
For example, <code>ExceptionRecognizerForSQLIntegrityConstraintViolationUniqueOrIndexException</code> checks if the exception inherits from <code>java.sql.SQLIntegrityConstraintViolationException</code>, and if so, constructs a suitable message.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="persisted-title"><a class="anchor" href="#persisted-title"></a>Persisted Title</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Normally the title of an object is not persisted to the database, rather it is recomputed automatically from underlying properties.
On occasion though you might want the title to also be persisted; either to make things easier for the DBA, or for an integration scenario, or to support full-text search.</p>
</div>
<div class="paragraph">
<p>We can implement this feature by either overriding the  <a href="#refguide:applib-cm:methods/lifecycle.adoc" class="page unresolved">lifecycle methods</a> or (probably better) subscribing to the <a href="#refguide:applib-cm:classes/lifecycleevent.adoc" class="page unresolved">lifecycle events</a>.</p>
</div>
<div class="paragraph">
<p>In the design we discuss here we make it a responsibility of the entities to persist the title as a property, by implementing a <code>ObjectWithPersistedTitle</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public interface ObjectWithPersistedTitle {
    @Programmatic                                   <i class="conum" data-value="1"></i><b>(1)</b>
    String getPersistedTitle();
    void setPersistedTitle(final String title);
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>we don&#8217;t want to expose this in the UI.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We can then define a subscribing domain service that leverage this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.springframework.context.event.EventListener;
import org.springframework.stereotype.Service;
import org.apache.isis.applib.events.lifecycle.ObjectPersistingEvent;
import org.apache.isis.applib.events.lifecycle.ObjectUpdatingEvent;
import lombok.val;

@Service
public class TitlingService {

    @EventListener(ObjectPersistingEvent.class)
    public void on(ObjectPersistingEvent ev) {
        handle(ev.getSource());
    }

    @EventListener(ObjectUpdatingEvent.class)
    public void on(ObjectUpdatingEvent ev) {
        handle(ev.getSource());
    }

    private void handle(final Object persistentInstance) {
        if(persistentInstance instanceof ObjectWithPersistedTitle) {
            val objectWithPersistedTitle =
                (ObjectWithPersistedTitle) persistentInstance;
            objectWithPersistedTitle.setPersistedTitle(titleService.titleOf(objectWithPersistedTitle));
        }
    }

    @Inject
    TitleService titleService;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above is probably the easiest and most straightforward design.
One could imagine other designs where the persisted title is stored elsewhere, such as a <a href="http://lucene.apache.org/">Apache Lucene</a> (or similar) database to allow for full-text searches.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="how-to-handle-void-and-null-results"><a class="anchor" href="#how-to-handle-void-and-null-results"></a>How to handle void/null results</h2>
<div class="sectionbody">
<div class="paragraph">
<p>From this <a href="http://isis.markmail.org/thread/yf7qdeiu3vrvk2ei">thread</a> on the Apache Isis users mailing list:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>When using a <code>void</code> action, let&#8217;s say a remove action, the user is redirected to a
page "no results".
When clicking the back button in the browser the user sees "Object not found" (since you&#8217;ve just deleted this object).</em></p>
</li>
<li>
<p><em>You can return a list for example to prevent the user from being redirect to a
"No results" page, but I think it&#8217;s not the responsibility of the controllers in
the domain model.</em></p>
</li>
<li>
<p><em>A solution could be that wicket viewer goes back one page when
  encountering a deleted object.
And refresh the current page when receiving a null response or invoking a void action.
But how to implement this?</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>One way to implement this idea is to provide a custom implementation of the <a href="../../../refguide/latest/applib-svc/RoutingService.html" class="page"><code>RoutingService</code></a> SPI domain service.
The default implementation will either return the current object (if not null), else the home page (as defined by <a href="../../../refguide/latest/applib-ant/HomePage.html" class="page"><code>@HomePage</code></a>) if one exists.</p>
</div>
<div class="paragraph">
<p>The following custom implementation refines this to use the breadcrumbs (available in the Wicket viewer) to return the first non-deleted domain object found in the list of breadcrumbs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.springframework.stereotype.Service;
import lombok.val;

@Service
@Order(OrderPrecedence.HIGH)                                              <i class="conum" data-value="1"></i><b>(1)</b>
public class RoutingServiceUsingBreadcrumbs
                  extends RoutingServiceDefault {
    @Override
    public Object route(final Object original) {
        if(original != null) {                                            <i class="conum" data-value="2"></i><b>(2)</b>
            return original;
        }
        repositoryService.flush();                                        <i class="conum" data-value="3"></i><b>(3)</b>

        val breadcrumbModelProvider =                                     <i class="conum" data-value="4"></i><b>(4)</b>
            (BreadcrumbModelProvider) AuthenticatedWebSession.get();
        val breadcrumbModel = breadcrumbModelProvider.getBreadcrumbModel();
        final List&lt;EntityModel&gt; breadcrumbs = breadcrumbModel.getList();

        val firstViewModelOrNonDeletedPojoIfAny =
                breadcrumbs.stream()                                      <i class="conum" data-value="5"></i><b>(5)</b>
                .filter(entityModel -&gt; entityModel != null)
                .map(EntityModel::getObject)                              <i class="conum" data-value="6"></i><b>(6)</b>
                .filter(Objects::nonNull)
                .map(ManagedObject::getObject)                            <i class="conum" data-value="7"></i><b>(7)</b>
                .filter(pojo -&gt;
                  metamodelService.sortOf(pojo, RELAXED) == VIEW_MODEL)   <i class="conum" data-value="8"></i><b>(8)</b>
                .findFirst();

        return firstViewModelOrNonDeletedPojoIfAny.orElse(homePage());    <i class="conum" data-value="9"></i><b>(9)</b>
    }
    private Object homePage() {
        return homePageResolverService.homePage();
    }

    @Inject HomePageResolverService homePageResolverService;
    @Inject MetaModelService metaModelService;
    @Inject RepositoryService repositoryService;
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>override the default imlpementation</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>if a non-null object was returned, then return this</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>ensure that any persisted objects have been deleted.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>reach inside the Wicket viewer&#8217;s internals to obtain the list of breadcrumbs.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>loop over all breadcrumbs</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>unwrap the Wicket viewer&#8217;s serializable representation of each domain object (<code>EntityModel</code>) to the Isis runtime&#8217;s representation (<code>ManagedObject</code>)</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>unwrap the Isis runtime&#8217;s representation of each domain object (<code>ManagedObject</code>) to the domain object pojo itself</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>if object is persistable (not a view model) then make sure it is not deleted</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>return the first object if any, otherwise the home page object (if any).</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="subclass-properties-in-tables"><a class="anchor" href="#subclass-properties-in-tables"></a>Subclass properties in tables</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Suppose you have a hierarchy of classes where a property is derived and abstract in the superclass, concrete implementations in the subclasses.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public abstract class LeaseTerm {
    public abstract BigDecimal getEffectiveValue();
    ...
}

public class LeaseTermForIndexableTerm extends LeaseTerm {
    public BigDecimal getEffectiveValue() { /* ... */ }
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Currently the Wicket viewer will not render the property in tables (though the property is correctly rendered in views).</p>
</div>
<div class="paragraph">
<p>The work-around is simple enough; make the method concrete in the superclass and return a dummy implementation, eg:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public abstract class LeaseTerm {
    public BigDecimal getEffectiveValue() {
        return null;
    }
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively the implementation could throw a <code>RuntimeException</code> (since the method is not intended to be called).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="how-to-implement-a-spellchecker"><a class="anchor" href="#how-to-implement-a-spellchecker"></a>How to implement a spellchecker?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>From this <a href="http://isis.markmail.org/thread/dduarjscrbnodfsi">thread</a> on the Apache Isis users mailing list:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>What is the easiest way to add a spell checker to the text written in a field in
a domain object, for instance to check English syntax?</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>One way to implement is to use the <a href="../../../refguide/latest/applib-svc/EventBusService.html" class="page">event bus</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set up a <a href="#refguide:applib-cm:classes/domainevent.adoc" class="page unresolved">domain event</a> subscriber that can veto the changes.</p>
</li>
<li>
<p>if the change is made through an action, you can use <a href="../../../refguide/latest/applib-ant/Action.html#domainEvent" class="page"><code>@Action#domainEvent</code></a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>if if the change is made through an edit, you can use <a href="../../../refguide/latest/applib-ant/Property.html#domainEvent" class="page"><code>@Property#domainEvent</code></a>.</p>
</div>
<div class="paragraph">
<p>You&#8217;ll need some way to know which fields should be spell checked.  Two ways spring to mind:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>either look at the domain event&#8217;s identifier</p>
</li>
<li>
<p>or subclass the domain event (recommended anyway) and have those subclass events implement some sort of marker interface, eg a <code>SpellCheckEvent</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And you&#8217;ll (obviously) also need some sort of spell checker implementation to call.</p>
</div>
</div>
</div>
</article>
<aside class="article-aside toc hide-for-print" role="navigation">
    <p class="toc-title">On this page</p>
    <div id="article-toc"></div>
</aside>
</main>
</div>
<footer class="footer">
    <div class="content">
        <div class="copyright">
            <p>
                Copyright © 2010~2020 The Apache Software Foundation, licensed under the Apache License, v2.0.
                <br/>
                Apache, the Apache feather logo, Apache Isis, and the Apache Isis project logo are all trademarks of The Apache Software Foundation.
            </p>
        </div>
        <div class="revision">
            <p>Revision: 2.0.0-M4.20201115-1730-fbc60c96</p>
        </div>
    </div>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/jquery-3.4.1.min.js"></script>
<script src="../../../_/js/vendor/jquery-ui-1.12.1.custom.widget-only.min.js"></script>
<script src="../../../_/js/vendor/jquery.tocify.min.js"></script>

<script>
    $(function() {
        $("#article-toc").tocify( {
            showEffect: "slideDown",
            hashGenerator: "pretty",
            hideEffect: "slideUp",
            selectors: "h2, h3",
            scrollTo: 120,
            smoothScroll: true,
            theme: "jqueryui",
            highlightOnScroll: true
        } );
    });
</script>

<script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script>
  function focusSearchInput () { document.querySelector('#algolia-search-input').focus() }
  var search = docsearch({
    appId: '5ISP5TFAEN',
    apiKey: '0fc51c28b4ad46e7318e96d4e97fab7c',
    indexName: 'isis-apache-org',
    inputSelector: '#algolia-search-input',
    autocompleteOptions: { hint: false, keyboardShortcuts: ['s'] },
    debug: false,
  }).autocomplete
  search.on('autocomplete:closed', function () { search.autocomplete.setVal() })
  focusSearchInput()
  window.addEventListener('load', focusSearchInput);
</script>

<!--
  docsearch options:
  https://docsearch.algolia.com/docs/behavior/
-->
<!--
  https://www.algolia.com/doc/api-reference/api-parameters/
  algoliaOptions: { hitsPerPage: 6 },
-->
  </body>
</html>
