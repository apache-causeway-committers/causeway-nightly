<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Pet entity :: causeway</title>
    <meta name="generator" content="Antora 3.1.14">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="stylesheet" href="../../../_/css/site-custom.css">
<link rel="home" href="../../.." title="causeway">
  <link rel="next" href="050-visit-entity.html" title="The &lt;code&gt;visit&lt;/code&gt; module and &lt;code&gt;Visit&lt;/code&gt; entity">
  <link rel="prev" href="030-petowner-entity.html" title="The &lt;code&gt;PetOwner&lt;/code&gt; entity">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../..">
          <span class="icon">
            <img src="../../../_/img/causeway-logo-no-words-65x48.png"></img>
          </span>
        <span class="navbar-title">causeway</span>
      </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <a class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Quick Start</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Starter Apps</span>
            <a class="navbar-item" href="../../../docs/latest/starters/helloworld.html">Hello World</a>
            <a class="navbar-item" href="../../../docs/latest/starters/simpleapp.html">Simple App</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Learning &amp; Tutorials</span>
            <a class="navbar-item" href="../../../docs/latest/reference/about.html">Reference App</a>
            <a class="navbar-item" href="https://danhaywood.gitlab.io/isis-petclinic-tutorial-docs/petclinic/1.16.2/intro.html">Petclinic</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Resources</span>
            <a class="navbar-item" href="../../../docs/latest/resources/cheatsheet.html">Cheatsheet</a>
            <a class="navbar-item" href="../../../docs/latest/resources/icons.html">Icons</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Guides</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Core</span>
            <a class="navbar-item" href="../../../userguide/latest/about.html">User Guide</a>
            <a class="navbar-item" href="../../../refguide/latest/about.html">Reference Guide</a>
            <a class="navbar-item" href="../../../testing/latest/about.html">Testing Guide</a>
            <a class="navbar-item" href="../../../security/latest/about.html">Security Guide</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">For use in apps</span>
            <a class="navbar-item" href="../../../valuetypes/latest/about.html">Value Types</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Development</span>
            <a class="navbar-item" href="../../../setupguide/latest/about.html">Setup Guide</a>
            <a class="navbar-item" href="../../../conguide/latest/about.html">Contributors' Guide</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Components</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Security</span>
            <a class="navbar-item" href="../../../security/latest/bypass/about.html">Bypass</a>
            <a class="navbar-item" href="../../../security/latest/simple/about.html">Simple</a>
            <a class="navbar-item" href="../../../security/latest/shiro/about.html">Shiro</a>
            <a class="navbar-item" href="../../../security/latest/spring/about.html">Spring</a>
            <a class="navbar-item" href="../../../security/latest/keycloak/about.html">Keycloak</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Viewers</span>
            <a class="navbar-item" href="../../../vw/latest/about.html">Web UI (Wicket)</a>
            <a class="navbar-item" href="../../../gqlv/latest/about.html">GraphQL API</a>
            <a class="navbar-item" href="../../../vro/latest/about.html">REST API (Restful Objects)</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Persistence</span>
            <a class="navbar-item" href="../../../pjpa/latest/about.html">JPA (EclipseLink)</a>
            <a class="navbar-item" href="../../../pjdo/latest/about.html">JDO (DataNucleus)</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Extensions</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Core</span>
            <a class="navbar-item" href="../../../userguide/latest/commandlog/about.html">Command Log</a>
            <a class="navbar-item" href="../../../userguide/latest/docgen/about.html">Doc Gen</a>
            <a class="navbar-item" href="../../../userguide/latest/executionlog/about.html">Execution Log</a>
            <a class="navbar-item" href="../../../userguide/latest/executionoutbox/about.html">Execution Outbox</a>
            <a class="navbar-item" href="../../../userguide/latest/executionrepublisher/about.html">Execution Republisher</a>
            <a class="navbar-item" href="../../../userguide/latest/excel/about.html">Excel</a>
            <a class="navbar-item" href="../../../userguide/latest/flyway/about.html">Flyway</a>
            <a class="navbar-item" href="../../../userguide/latest/layoutloaders/about.html">Layout Loaders</a>
            <a class="navbar-item" href="../../../userguide/latest/titlecache/about.html">Title Cache</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Security</span>
            <a class="navbar-item" href="../../../security/latest/secman/about.html">Secman</a>
            <a class="navbar-item" href="../../../security/latest/audittrail/about.html">Audit Trail</a>
            <a class="navbar-item" href="../../../security/latest/spring-oauth2/about.html">Spring OAuth2 Integration</a>
            <a class="navbar-item" href="../../../security/latest/shiro-realm-ldap/about.html">LDAP Realm for Shiro</a>
            <a class="navbar-item" href="../../../security/latest/sessionlog/about.html">Session Log</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Web UI (Wicket)</span>
            <a class="navbar-item" href="../../../vw/latest/fullcalendar/about.html">Full Calendar</a>
            <a class="navbar-item" href="../../../vw/latest/pdfjs/about.html">pdf.js</a>
            <a class="navbar-item" href="../../../vw/latest/sse/about.html">Server Side Events</a>
            <a class="navbar-item" href="../../../vw/latest/tabular/about.html">Tabular Download</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">REST API (Restful Objects)</span>
            <a class="navbar-item" href="../../../vro/latest/cors/about.html">CORS</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Support</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Contact</span>
            <a class="navbar-item" href="../../../docs/latest/support/slack-channel.html">Slack</a>
            <a class="navbar-item" href="../../../docs/latest/support/mailing-list.html">Mailing Lists</a>
            <a class="navbar-item" href="https://issues.apache.org/jira/browse/CAUSEWAY">JIRA</a>
            <a class="navbar-item" href="https://stackoverflow.com/questions/tagged/causeway">Stack Overflow</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Releases</span>
            <a class="navbar-item" href="../../../docs/latest/downloads/how-to.html">Downloads</a>
            <a class="navbar-item" href="../../../relnotes/latest/about.html">Release Notes</a>
            <hr class="navbar-divider"/>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Framework</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Process</span>
            <a class="navbar-item" href="../../../comguide/latest/about.html">Committers' Guide</a>
            <a class="navbar-item" href="../../../tooling/latest/about.html">Tooling</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Automated Analysis</span>
            <a class="navbar-item" href="https://sonarcloud.io/dashboard?id=apache_causeway">SonarCloud.io</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Interim Builds</span>
            <a class="navbar-item" href="../../../comguide/latest/nightly-builds.html">Nightly builds</a>
            <a class="navbar-item" href="../../../comguide/latest/weekly-builds.html">Weekly builds</a>
            <a class="navbar-item" href="https://apache-causeway-committers.github.io/causeway-nightly">Website Preview (not ASF hosted)</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Development</span>
            <a class="navbar-item" href="../../../core/latest/about.html">Internal Design Docs</a>
            <a class="navbar-item" href="../../../regressiontests/latest/about.html">Regression Tests</a>
            <a class="navbar-item" href="../../../incubator/latest/about.html">Incubator</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Thanks</span>
            <a class="navbar-item" href="../../../more-thanks/latest/more-thanks.html">Acknowledgements</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">ASF</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="http://www.apache.org/">Apache Homepage</a>
            <a class="navbar-item" href="https://www.apache.org/events/current-event">Events</a>
            <a class="navbar-item" href="https://www.apache.org/licenses/">License</a>
            <a class="navbar-item" href="https://www.apache.org/security/">Security</a>
            <a class="navbar-item" href="https://privacy.apache.org/policies/privacy-policy-public.html">Privacy</a>
            <a class="navbar-item" href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a>
            <a class="navbar-item" href="https://www.apache.org/foundation/thanks.html">Thanks</a>
            <hr class="navbar-divider"/>
            <a class="navbar-item" href="https://whimsy.apache.org/board/minutes/Causeway.html">PMC board minutes</a>
          </div>
        </div>
        <a class="navbar-item" href="../../../docs/latest/about.html">
          <span class="icon">
            <img src="../../../_/img/home.png"></img>
          </span>
        </a>
      </div>
    </div>
  </nav>
</header>
<div class="body ">
<div class="nav-container" data-component="tutorials" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-search hide-for-print">
  <input id="algolia-search-input" placeholder="Search"></span>
</div>
<div class="nav-panel-pagination">
  <a class="page-previous" rel="prev" href="030-petowner-entity.html" title="The &lt;code&gt;PetOwner&lt;/code&gt; entity"><span></span></a>
  <a class="page-next" rel="next"
     href="050-visit-entity.html" title="The &lt;code&gt;visit&lt;/code&gt; module and &lt;code&gt;Visit&lt;/code&gt; entity"><span></span></a>
<!--
page.parent doesn't seem to be set...
  <a class="page-parent disabled" rel="prev" href="" title="The &lt;code&gt;PetOwner&lt;/code&gt; entity"><span></span></a>
-->
</div>
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../about.html">Tutorials</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="010-getting-started.html">Getting Started</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="010-getting-started.html#prereqs">Prereqs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="010-getting-started.html#exercise-1-1-starter-apps-clone-the-repo"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>1.1</strong>: Starter apps / clone the repo</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="010-getting-started.html#exercise-1-2-explore-the-simple-app">1.2: Explore the Simple App</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="010-getting-started.html#exercise-1-3-running-from-the-ide">1.3: Running from the IDE</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="010-getting-started.html#exercise-1-4-naked-objects-pattern">1.4: Naked Objects pattern</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="010-getting-started.html#exercise-1-5-ui-hints">1.5: UI Hints</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="020-the-petclinic-domain.html">The PetClinic Domain and <code>petowner</code> module</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="020-the-petclinic-domain.html#exercise-2-1-create-a-new-petowner-module"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>2.1</strong>: Create new <code>petowner</code> module</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="020-the-petclinic-domain.html#exercise-2-2-configure-the-app-to-include-the-petowner-module"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>2.2</strong>: Include the <code>petowner</code> module</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="020-the-petclinic-domain.html#exercise-2-3-add-security-role-for-petowner-module"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>2.3</strong>: Add security role for the <code>petowner</code> module</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="020-the-petclinic-domain.html#exercise-2-4-update-menubar-for-PetOwners"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>2.4</strong>: Update menubar for <code>PetOwners</code></a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="020-the-petclinic-domain.html#exercise-2-5-setup-demo-PetOwners"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>2.5</strong>: Setup demo <code>PetOwner</code>s</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="030-petowner-entity.html">The <code>PetOwner</code> entity</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="030-petowner-entity.html#exercise-3-1-add-petowners-knownAs-property"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>3.1</strong>: Add <code>PetOwner</code>'s <code>knownAs</code> property</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="030-petowner-entity.html#exercise-3-2-define-PetOwners-title-imperatively"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>3.2</strong>: Define <code>PetOwner</code>'s title imperatively</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="030-petowner-entity.html#exercise-3-3-remaining-PetOwner-properties"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>3.3</strong>: Add remaining <code>PetOwner</code> properties</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="030-petowner-entity.html#exercise-3-4-list-new-properties-of-PetOwner"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>3.4</strong>: List new properties of <code>PetOwner</code></a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="030-petowner-entity.html#exercise-3-5-initial-fixture-script"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>3.5</strong>: Initial Fixture Script</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="030-petowner-entity.html#exercise-3-6-update-home-page-to-show-PetOwners"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>3.6</strong>:  Update Home Page to show <code>PetOwner</code>s</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="030-petowner-entity.html#exercise-3-7-modify-the-menu-action-that-creates-petowners"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>3.7</strong>: Modify the menu action that creates <code>PetOwner</code>s</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="030-petowner-entity.html#exercise-3-8-prompt-styles"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>3.8</strong>: Prompt styles</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="030-petowner-entity.html#exercise-3-9-derived-days-since-last-visit-property"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>3.9</strong>: Derived 'days since last visit' property</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="030-petowner-entity.html#exercise-3-10-use-meta-annotations-to-reduce-duplication"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>3.10</strong>: Use meta-annotations to reduce duplication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="030-petowner-entity.html#exercise-3-11-validation"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>3.11</strong>: Validation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="030-petowner-entity.html#exercise-3-12-more-validation"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>3.12</strong>: More validation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="030-petowner-entity.html#exercise-3-13-scalar-custom-value-types"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>3.13</strong>: Scalar custom value types</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="030-petowner-entity.html#exercise-3-14-use-layout-xml-file-for-ui-semantics"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>3.14</strong>: Use layout xml file for UI semantics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="030-petowner-entity.html#exercise-3-15-update-icon-for-pet-owner"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>3.15</strong>: Update icon for <code>PetOwner</code></a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="040-pet-entity.html">The <code>Pet</code> entity</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#exercise-4-1-pet-entitys-key-properties"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>4.1</strong>: <code>Pet</code> entity&#8217;s key properties</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#exercise-4-2-add-pet-ui-and-layout-semantics"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>4.2</strong>: Add <code>Pet</code>'s UI and layout semantics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#exercise-4-3-add-petowners-collection-of-pets"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>4.3</strong>: Add <code>PetOwner</code>'s collection of <code>Pet</code>s</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#exercise-4-4-add-actions-to-add-or-remove-pets"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>4.4</strong>: Add actions to add or remove <code>Pet</code>s</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#exercise-4-5-extend-the-fixture-data-to-add-in-Pets"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>4.5</strong>: Extend the fixture data to add in <code>Pet</code>s</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#exercise-4-6-add-action-validation"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>4.6</strong>: Unique <code>Pet</code> names (action validation)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#exercise-4-7-add-pets-remaining-properties"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>4.7</strong>: Add <code>Pet</code>'s remaining properties</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#exercise-4-8-dynamic-icons-for-pet"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>4.8</strong>: Add dynamic icons for <code>Pet</code></a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="050-visit-entity.html">The <code>visit</code> module and <code>Visit</code> entity</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="050-visit-entity.html#exercise-5-1-the-visits-module"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>5.1</strong>: The <code>visit</code> module</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="050-visit-entity.html#exercise-5-2-visit-module-dependencies"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>5.2</strong>: The <code>visit</code> module dependencies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="050-visit-entity.html#exercise-5-3-visit-entitys-key-properties"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>5.3</strong>: <code>Visit</code> entity&#8217;s key properties</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="050-visit-entity.html#exercise-5-4-book-visit-action"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>5.4</strong>: The "Book Visit" action</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="060-unit-testing.html">Unit Testing</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="060-unit-testing.html#exercise-6-1-unit-test-the-default-time-when-booking-visits"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>6.1</strong>: Unit test the default time when booking visits</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="070-modularity.html">Modularity (domain events)</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="070-modularity.html#exercise-7-1-refactor-petowners-delete-action"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>7.1</strong>: refactor <code>PetOwner</code>'s delete action</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="080-view-models.html">View Models</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="080-view-models.html#exercise-8-1-extend-the-home-page"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>8.1</strong>: Extend the Home Page.</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="080-view-models.html#exercise-8-2-add-a-convenience-action"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>8.2</strong>: Add a convenience action</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="090-integration-testing.html">Integration Testing</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="090-integration-testing.html#exercise-9-1-testing-bookvisit-using-an-integtest"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>9.1</strong>: Testing <code>bookVisit()</code> using an integtest</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="090-integration-testing.html#exercise-9-2-adds-visit-fixture"><span class="image"><img src="_images/hand.png" alt="hand"></span> <strong>9.2</strong>: Adds fixtures for the <code>visit</code> module</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Tutorials</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title"> </span>
      <ul class="versions">
        <li class="version">
          <a href="../../../docs/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Committers' Guide</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../comguide/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Contributors' Guide</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../conguide/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Design Docs</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../core/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Extensions</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../extensions/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">GraphQL Viewer</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../gqlv/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Incubator Catalog</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../incubator/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">JDO/DataNucleus</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../pjdo/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">JPA</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../pjpa/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">QueryDSL</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../querydsl/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Reference Guide</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../refguide/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">regressiontests</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../regressiontests/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Release Notes</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../relnotes/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">REST API (Restful Objects Viewer)</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../vro/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Security Guide</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../security/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Setup Guide</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../setupguide/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Testing Guide</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../testing/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Tutorials</span>
      <ul class="versions">
        <li class="version is-current">
          <a href="../about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">User Guide</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../userguide/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Value Types Catalog</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../valuetypes/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Web UI (Wicket Viewer)</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../vw/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main role="main">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../docs/latest/about.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../about.html">Tutorials</a></li>
    <li><a href="040-pet-entity.html">The <code>Pet</code> entity</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/apache/causeway/edit/main/antora/components/tutorials/modules/petclinic/pages/040-pet-entity.adoc">Edit</a></div>
</div>
<article class="doc">
    <a name="section-top"></a>
<h1 class="page">Pet entity</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Right now our domain model still only consists of the single domain class, <code>PetOwner</code>.
We still have the <code>Pet</code> and <code>Visit</code> entities to add, along with the <code>PetSpecies</code>  enum.</p>
</div>
<div class="imageblock kroki">
<div class="content">
<object type="image/svg+xml" data="_images/diag-39fc1b7da8c879b2ea17cf3104c3513911d7f8c4.svg"><span class="alt">Diagram</span></object>
</div>
</div>
<div class="paragraph">
<p>In this set of exercises we&#8217;ll focus on the <code>Pet</code> entity and its relationship with <code>PetOwner</code>.
Each <code>PetOwner</code> will hold a collection of their <code>Pet</code>s, with actions to add or remove <code>Pet</code> instances for that collection.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="exercise-4-1-pet-entitys-key-properties"><a class="anchor" href="#exercise-4-1-pet-entitys-key-properties"></a>Ex 4.1: Pet entity&#8217;s key properties</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this exercise we&#8217;ll just create the outline of the <code>Pet</code> entity, and ensure it is mapped to the database correctly.</p>
</div>
<div class="sect2">
<h3 id="solution"><a class="anchor" href="#solution"></a>Solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git checkout tags/3.2.0/04-01-pet-entity-key-properties
mvn clean install
mvn -pl webapp spring-boot:run -Dspring-boot.run.jvmArguments="-Dspring.profiles.active=dev"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="tasks"><a class="anchor" href="#tasks"></a>Tasks</h3>
<div class="ulist">
<ul>
<li>
<p>create a meta-annotation <code>@PetName</code> for the Pet&#8217;s name:</p>
<div class="listingblock">
<div class="title">PetName.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Property(maxLength = PetName.MAX_LEN, optionality = Optionality.MANDATORY)
@Parameter(maxLength = PetName.MAX_LEN, optionality = Optionality.MANDATORY)
@Target({ ElementType.METHOD, ElementType.FIELD, ElementType.PARAMETER, ElementType.ANNOTATION_TYPE })
@Retention(RetentionPolicy.RUNTIME)
public @interface PetName {

    int MAX_LEN = 60;
}</code></pre>
</div>
</div>
</li>
<li>
<p>create the <code>Pet</code> entity, using the <code>@PetName</code> meta-annotation for the <code>name</code> property:</p>
<div class="listingblock">
<div class="title">Pet.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Entity
@Table(
        schema= PetOwnerModule.SCHEMA,
        uniqueConstraints = {
                @UniqueConstraint(name = "Pet__owner_name__UNQ", columnNames = {"owner_id, name"})
        }
)
@EntityListeners(CausewayEntityListener.class)
@Named(PetOwnerModule.NAMESPACE + ".Pet")
@DomainObject(entityChangePublishing = Publishing.ENABLED)
@DomainObjectLayout()
@NoArgsConstructor(access = AccessLevel.PUBLIC)
@XmlJavaTypeAdapter(PersistentEntityAdapter.class)
@ToString(onlyExplicitlyIncluded = true)
public class Pet implements Comparable&lt;Pet&gt; {

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    @Column(name = "id", nullable = false)
    @Getter @Setter
    private Long id;

    @Version
    @Column(name = "version", nullable = false)
    @PropertyLayout(fieldSetId = "metadata", sequence = "999")  <i class="conum" data-value="1"></i><b>(1)</b>
    @Getter @Setter
    private long version;


    Pet(PetOwner petOwner, String name) {
        this.petOwner = petOwner;
        this.name = name;
    }


    @ManyToOne(optional = false)
    @JoinColumn(name = "owner_id")
    @PropertyLayout(fieldSetId = "identity", sequence = "1")    <i class="conum" data-value="1"></i><b>(1)</b>
    @Getter @Setter
    private PetOwner petOwner;

    @PetName
    @Column(name = "name", length = PetName.MAX_LEN, nullable = false)
    @Getter @Setter
    @PropertyLayout(fieldSetId = "identity", sequence = "2")    <i class="conum" data-value="1"></i><b>(1)</b>
    private String name;


    private final static Comparator&lt;Pet&gt; comparator =
            Comparator.comparing(Pet::getPetOwner).thenComparing(Pet::getName);

    @Override
    public int compareTo(final Pet other) {
        return comparator.compare(this, other);
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>we&#8217;ll look at the layout in the next exercise.</td>
</tr>
</table>
</div>
</li>
<li>
<p>locate the owning module, <code>PetOwnerModule</code>.
Add in a line to delete all <code>Pet</code> entities on teardown:</p>
<div class="listingblock">
<div class="title">PetOwnerModule.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
public FixtureScript getTeardownFixture() {
    return new TeardownFixtureJpaAbstract() {
        @Override
        protected void execute(ExecutionContext executionContext) {
            deleteFrom(Pet.class);          <i class="conum" data-value="1"></i><b>(1)</b>
            deleteFrom(PetOwner.class);
        }
    };
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This lne must come before the deletion of <code>PetOwner</code>s, because (in a later exercise) the <code>PetOwner</code> entity will have child <code>Pet</code> entities; we always delete from the leaf level up.
<div class="paragraph">
<p>This is used during integration tests, to reset the database after each test.</p>
</div></td>
</tr>
</table>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Run the application, and confirm that the application starts correctly.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s also confirm that JPA created the corresponding table automatically:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Login as <code>secman-admin</code> login (password: <code>pass</code>)</p>
</li>
<li>
<p>Access the <span class="menuseq"><b class="menu">Prototyping</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">H2 Console</b></span>:</p>
<div class="imageblock">
<div class="content">
<img src="_images/04-01/h2-console-prompt.png" alt="h2 console prompt">
</div>
</div>
</li>
<li>
<p>Connect.
There is no password for <code>sa</code>.</p>
</li>
<li>
<p>Confirm the <code>Pet</code> table is created correctly:</p>
<div class="imageblock">
<div class="content">
<img src="_images/04-01/pet-and-petowner-tables-created.png" alt="pet and petowner tables created">
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="exercise-4-2-add-pet-ui-and-layout-semantics"><a class="anchor" href="#exercise-4-2-add-pet-ui-and-layout-semantics"></a>Ex 4.2: Add Pet&#8217;s UI and layout semantics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Next, let&#8217;s add in the UI and layout semantics for <code>Pet</code>.
At the moment we&#8217;re "flying blind" because we don&#8217;t have any demo <code>Pet</code> instances to see, but we can refine these files later; it&#8217;s good to have some scaffolding.</p>
</div>
<div class="sect2">
<h3 id="solution-2"><a class="anchor" href="#solution-2"></a>Solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git checkout tags/3.2.0/04-02-pet-ui-and-layout-semantics
mvn clean install
mvn -pl webapp spring-boot:run -Dspring-boot.run.jvmArguments="-Dspring.profiles.active=dev"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="tasks-2"><a class="anchor" href="#tasks-2"></a>Tasks</h3>
<div class="ulist">
<ul>
<li>
<p>annotate the <code>Pet#name</code> property with <a href="../../../refguide/latest/applib/index/annotation/Title.html" class="xref page">@Title</a>:</p>
<div class="listingblock">
<div class="title">Pet.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@PetName
@Title                                                              <i class="conum" data-value="1"></i><b>(1)</b>
@Column(name = "name", length = PetName.MAX_LEN, nullable = false)
@Getter @Setter
@PropertyLayout(fieldSetId = "identity", sequence = "2")
private String name;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>added</td>
</tr>
</table>
</div>
</li>
<li>
<p>create a <code>.layout.xml</code> file for <code>Pet</code> (easiest is to copy an existing one and adapt)</p>
<div class="listingblock">
<div class="title">Pet.layout.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;
&lt;bs3:grid
        xsi:schemaLocation="https://causeway.apache.org/applib/layout/component https://causeway.apache.org/applib/layout/component/component.xsd https://causeway.apache.org/applib/layout/grid/bootstrap3 https://causeway.apache.org/applib/layout/grid/bootstrap3/bootstrap3.xsd"
        xmlns:cpt="https://causeway.apache.org/applib/layout/component"
        xmlns:bs3="https://causeway.apache.org/applib/layout/grid/bootstrap3"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
    &lt;bs3:row&gt;
        &lt;bs3:col span="12" unreferencedActions="true"&gt;
            &lt;cpt:domainObject bookmarking="AS_ROOT"/&gt;
        &lt;/bs3:col&gt;
    &lt;/bs3:row&gt;
    &lt;bs3:row&gt;
        &lt;bs3:col span="6"&gt;
            &lt;bs3:row&gt;
                &lt;bs3:col span="12"&gt;
                    &lt;bs3:tabGroup&gt;
                        &lt;bs3:tab name="Identity"&gt;
                            &lt;bs3:row&gt;
                                &lt;bs3:col span="12"&gt;
                                    &lt;cpt:fieldSet name="Identity" id="identity"/&gt;
                                &lt;/bs3:col&gt;
                            &lt;/bs3:row&gt;
                        &lt;/bs3:tab&gt;
                        &lt;bs3:tab name="Other"&gt;
                            &lt;bs3:row&gt;
                                &lt;bs3:col span="12"&gt;
                                    &lt;cpt:fieldSet name="Other" id="other" unreferencedProperties="true"/&gt;
                                &lt;/bs3:col&gt;
                            &lt;/bs3:row&gt;
                        &lt;/bs3:tab&gt;
                        &lt;bs3:tab name="Metadata"&gt;
                            &lt;bs3:row&gt;
                                &lt;bs3:col span="12"&gt;
                                    &lt;cpt:fieldSet name="Metadata" id="metadata"/&gt;
                                &lt;/bs3:col&gt;
                            &lt;/bs3:row&gt;
                        &lt;/bs3:tab&gt;
                    &lt;/bs3:tabGroup&gt;
                &lt;/bs3:col&gt;
                &lt;bs3:col span="12"&gt;
                    &lt;cpt:fieldSet name="Details" id="details"/&gt;
                &lt;/bs3:col&gt;
            &lt;/bs3:row&gt;
        &lt;/bs3:col&gt;
        &lt;bs3:col span="6"&gt;
            &lt;bs3:row&gt;
                &lt;bs3:col span="12"&gt;
                &lt;/bs3:col&gt;
            &lt;/bs3:row&gt;
            &lt;bs3:tabGroup  unreferencedCollections="true"&gt;
            &lt;/bs3:tabGroup&gt;
        &lt;/bs3:col&gt;
    &lt;/bs3:row&gt;
&lt;/bs3:grid&gt;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
An alternative way to create the layout file is to run the application, obtain/create an instance of the domain object in question (eg <code>Pet</code>) and then download the inferred layout XML from the metadata menu.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>next, download a suitable icon to represent the pet; name it a <code>Pet.png</code></p>
</li>
<li>
<p>create column order file, used to determine the order of columns of any actions that might be written that return a list of <code>Pet</code>s</p>
<div class="listingblock">
<div class="title">Pet.columnOrder.txt</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">petOwner
name
#id
#version</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="exercise-4-3-add-petowners-collection-of-pets"><a class="anchor" href="#exercise-4-3-add-petowners-collection-of-pets"></a>Ex 4.3: Add PetOwner&#8217;s collection of Pets</h2>
<div class="sectionbody">
<div class="paragraph">
<p>According to our model, <code>Pet</code>s are owned by <code>PetOwner</code>s:</p>
</div>
<div class="imageblock kroki">
<div class="content">
<object type="image/svg+xml" data="_images/diag-eaa9d52f1ae08b5e73724e105ad23df2795cf652.svg"><span class="alt">Diagram</span></object>
</div>
</div>
<div class="paragraph">
<p>In this next exercise we&#8217;ll add the <code>PetOwner</code>'s collection of <code>Pet</code>s.</p>
</div>
<div class="sect2">
<h3 id="solution-3"><a class="anchor" href="#solution-3"></a>Solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git checkout tags/3.2.0/04-03-PetOwner-pets-collection
mvn clean install
mvn -pl webapp spring-boot:run -Dspring-boot.run.jvmArguments="-Dspring.profiles.active=dev"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="tasks-3"><a class="anchor" href="#tasks-3"></a>Tasks</h3>
<div class="ulist">
<ul>
<li>
<p>update the <code>PetOwner</code> class, add a <code>pets</code> collection:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@org.apache.causeway.applib.annotation.Collection
@Getter
@OneToMany(mappedBy = "petOwner", cascade = CascadeType.ALL, orphanRemoval = true)
private Set&lt;Pet&gt; pets = new TreeSet&lt;&gt;();</code></pre>
</div>
</div>
</li>
<li>
<p>update <code>PetOwner.layout.xml</code> file to position the <code>pets</code> collection on the right-hand side, above the <code>attachment</code> property:</p>
<div class="listingblock">
<div class="title">PetOwner.layout.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;bs3:col span="6"&gt;
    &lt;bs3:row&gt;
        &lt;bs3:col span="12"&gt;
            &lt;bs3:row&gt;
                &lt;bs3:col span="12"&gt;
                    &lt;cpt:collection id="pets"/&gt;
                &lt;/bs3:col&gt;
            &lt;/bs3:row&gt;
            &lt;cpt:fieldSet name="Content" id="content"&gt;
                &lt;cpt:property id="attachment"&gt;
                    &lt;cpt:action id="updateAttachment" position="PANEL"/&gt;
                &lt;/cpt:property&gt;
            &lt;/cpt:fieldSet&gt;
        &lt;/bs3:col&gt;
    &lt;/bs3:row&gt;
    &lt;bs3:tabGroup  unreferencedCollections="true"&gt;
    &lt;/bs3:tabGroup&gt;
&lt;/bs3:col&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>Create a column order file to define the order of columns in the <code>PetOwner</code>'s <code>pets</code> collection.
It should be in the same package as <code>PetOwner</code>:</p>
<div class="listingblock">
<div class="title">PetOwner#pets.columnOrder.txt</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">name
#id
#version
#petOwner</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Run the application to confirm that the <code>pets</code> collection is visible and that the column order in the <code>pets</code> collection is correct.
(It won&#8217;t have any <code>Pet</code> instances in it just yet, of course).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="exercise-4-4-add-actions-to-add-or-remove-pets"><a class="anchor" href="#exercise-4-4-add-actions-to-add-or-remove-pets"></a>Ex 4.4: Add actions to add or remove Pets</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Given that a <code>PetOwner</code> knows the <code>Pet</code>(s) that they own, it seems a reasonable responsibility to maintain this collection using behaviour on the <code>PetOwner</code>.</p>
</div>
<div class="paragraph">
<p>So in this exercise we&#8217;ll add two actions on <code>PetOwner</code>: one to add a <code>Pet</code> and one to remove.</p>
</div>
<div class="sect2">
<h3 id="solution-4"><a class="anchor" href="#solution-4"></a>Solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git checkout tags/3.2.0/04-04-add-remove-pets
mvn clean install
mvn -pl webapp spring-boot:run -Dspring-boot.run.jvmArguments="-Dspring.profiles.active=dev"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="tasks-4"><a class="anchor" href="#tasks-4"></a>Tasks</h3>
<div class="ulist">
<ul>
<li>
<p>within <code>PetOwner</code>, create the <code>addPet</code> action:</p>
<div class="listingblock">
<div class="title">Pet.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Action
@ActionLayout(associateWith = "pets", sequence = "1")   <i class="conum" data-value="1"></i><b>(1)</b>
public PetOwner addPet(@PetName final String name) {
    final var pet = new Pet();
    pet.setName(name);
    pet.setPetOwner(this);
    pets.add(pet);
    return this;
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>UI hint to render button near the <code>pets</code> collection</td>
</tr>
</table>
</div>
</li>
<li>
<p>and create the <code>removePet</code> action:</p>
<div class="listingblock">
<div class="title">Pet.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Action(choicesFrom = "pets")                           <i class="conum" data-value="1"></i><b>(1)</b>
@ActionLayout(associateWith = "pets", sequence = "2")   <i class="conum" data-value="2"></i><b>(2)</b>
public PetOwner removePet(@PetName final Pet pet) {     <i class="conum" data-value="1"></i><b>(1)</b>
    pets.remove(pet);                                   <i class="conum" data-value="3"></i><b>(3)</b>
    return this;
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Indicates that a drop-down list of choices for the parameter should be taken from the <code>pets</code> collection</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>UI hint to render button near the <code>pets</code> collection</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>To delete the object, it&#8217;s sufficient to simply remove from the <code>PetOwner#pets</code> collection, because <code>orphanRemoval</code> was set to <code>true</code></td>
</tr>
</table>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Run the application and confirm that you can now add and remove pets for a pet owner.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="exercise-4-5-extend-the-fixture-data-to-add-in-Pets"><a class="anchor" href="#exercise-4-5-extend-the-fixture-data-to-add-in-Pets"></a>Ex 4.5: Extend the fixture data to add in Pets</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this exercise we&#8217;ll extend the fixture data so that each of our pet owners have one or several pets.</p>
</div>
<div class="sect2">
<h3 id="solution-5"><a class="anchor" href="#solution-5"></a>Solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git checkout tags/3.2.0/04-05-extend-fixture-data-to-add-in-pets
mvn clean install
mvn -pl webapp spring-boot:run -Dspring-boot.run.jvmArguments="-Dspring.profiles.active=dev"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="tasks-5"><a class="anchor" href="#tasks-5"></a>Tasks</h3>
<div class="ulist">
<ul>
<li>
<p>update the enum constants of <code>PetOwner_persona</code>, adding a fourth parameter of pet names:</p>
<div class="listingblock">
<div class="title">PetOwner_persona.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">JAMAL("Jamal Washington","jamal.pdf","J",new String[] {"Max"}),
CAMILA("Camila González","camila.pdf",null,new String[] {"Mia", "Coco", "Bella"}),
ARJUN("Arjun Patel","arjun.pdf",null,new String[] {"Rocky", "Charlie", "Buddy"}),
NIA("Nia Robinson","nia.pdf",null,new String[] {"Luna"}),
OLIVIA("Olivia Hartman","olivia.pdf",null,new String[] {"Molly", "Lucy", "Daisy"}),
LEILA("Leila Hassan","leila.pdf",null,new String[] {"Bruno"}),
MATT("Matthew Miller","matt.pdf","Matt",new String[] {"Simba"}),
BENJAMIN("Benjamin Thatcher","benjamin.pdf","Ben",new String[] {"Oliver"}),
JESSICA("Jessica Raynor","jessica.pdf","Jess",new String[] {"Milo", "Lucky"}),
DANIEL("Daniel Keating","daniel.pdf","Dan",new String[] {"Sam", "Roxy", "Smokey"});

// ...
private final String[] petNames;</code></pre>
</div>
</div>
</li>
<li>
<p>in the <code>PetOwner_persona.Builder</code> class, use the <code>petNames</code> to add pets to each owner:</p>
<div class="listingblock">
<div class="title">PetOwner_persona.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
protected PetOwner buildResult(final ExecutionContext ec) {

    // ...

    Arrays.stream(persona.petNames).forEach(petOwner::addPet);

    return petOwner;
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Run the application and confirm that each pet owner has one or several pets associated with them.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="exercise-4-6-add-action-validation"><a class="anchor" href="#exercise-4-6-add-action-validation"></a>Ex 4.6: Unique pet names (action validation)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>So far our pet clinic app is mostly a CRUD (create/read/update/delete) application.
Nothing wrong with that, and of course there are lots of tools and frameworks out there aside from Apache Causeway that can do this.</p>
</div>
<div class="paragraph">
<p>Where Causeway really shines though is the ease in which more complicated business logic can be implemented.</p>
</div>
<div class="paragraph">
<p>We&#8217;ll see several examples of this as we flesh out the pet clinic.
In this exercise we&#8217;ll introduce a simple business rule: every owner&#8217;s pet must have a different name.</p>
</div>
<div class="sect2">
<h3 id="solution-6"><a class="anchor" href="#solution-6"></a>Solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git checkout tags/3.2.0/04-06-unique-pet-names-validation
mvn clean install
mvn -pl webapp spring-boot:run -Dspring-boot.run.jvmArguments="-Dspring.profiles.active=dev"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="tasks-6"><a class="anchor" href="#tasks-6"></a>Tasks</h3>
<div class="listingblock">
<div class="title">PetOwner.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@MemberSupport                                                          <i class="conum" data-value="1"></i><b>(1)</b>
public String validate0AddPet(final String name) {                      <i class="conum" data-value="2"></i><b>(2)</b>
    if (getPets().stream().anyMatch(x -&gt; Objects.equals(x.getName(), name))) {
        return "This owner already has a pet called '" + name + "'";    <i class="conum" data-value="3"></i><b>(3)</b>
    }
    return null;                                                        <i class="conum" data-value="4"></i><b>(4)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Indicates that this method is part of the Causeway metamodel</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Naming convention indicates that this is the validation of the 0<sup>th</sup> parameter of <code>addPet</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>If a non-null value is returned, the framework uses its as the reason the action cannot be invoked</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>If null is returned then the validation has succeeded.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Run the application and confirm that the validation is working as you expect.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="exercise-4-7-add-pets-remaining-properties"><a class="anchor" href="#exercise-4-7-add-pets-remaining-properties"></a>Ex 4.7: Add Pet&#8217;s remaining properties</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this exercise we&#8217;ll add the remaining properties for <code>Pet</code>.
Let&#8217;s remind ourselves of the domain:</p>
</div>
<div class="imageblock kroki">
<div class="content">
<object type="image/svg+xml" data="_images/diag-1083d8aaada0e637a3f1882a9e3121b9befe9abd.svg"><span class="alt">Diagram</span></object>
</div>
</div>
<div class="paragraph">
<p>So, we need to add a <code>species</code>, and some <code>notes</code>.</p>
</div>
<div class="sect2">
<h3 id="solution-7"><a class="anchor" href="#solution-7"></a>Solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git checkout tags/3.2.0/04-07-pet-remaining-properties
mvn clean install
mvn -pl webapp spring-boot:run -Dspring-boot.run.jvmArguments="-Dspring.profiles.active=dev"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="tasks-7"><a class="anchor" href="#tasks-7"></a>Tasks</h3>
<div class="ulist">
<ul>
<li>
<p>declare the <code>PetSpecies</code> enum:</p>
<div class="listingblock">
<div class="title">PetSpecies.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public enum PetSpecies {
    Dog,
    Cat,
    Hamster,
    Budgerigar,
}</code></pre>
</div>
</div>
</li>
<li>
<p>add in a reference to <code>PetSpecies</code>:</p>
<div class="listingblock">
<div class="title">Pet.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Enumerated(EnumType.STRING)                                <i class="conum" data-value="1"></i><b>(1)</b>
@Column(nullable = false)
@Getter @Setter
@PropertyLayout(fieldSetId = "details", sequence = "1")
private PetSpecies species;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>mapped to a string rather than an integer value in the database</td>
</tr>
</table>
</div>
</li>
<li>
<p>As the <code>petSpecies</code> property is mandatory, also update the <code>PetOwner#addPet</code> action:</p>
<div class="listingblock">
<div class="title">PetOwner.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Action
@ActionLayout(associateWith = "pets", sequence = "1")
public PetOwner addPet(@PetName final String name, final PetSpecies species) {
    final var pet = new Pet();
    pet.setName(name);
    pet.setSpecies(species);
    pet.setPetOwner(this);
    pets.add(pet);
    return this;
}</code></pre>
</div>
</div>
</li>
<li>
<p>we also need to update the <code>PetOwner_persona.Builder</code>, because that uses this domain logic.
We&#8217;ll use the <a href="../../../refguide/latest/testing/index/fakedata/applib/services/FakeDataService.html" class="xref page">FakeDataService</a> to select a species at random:</p>
<div class="listingblock">
<div class="title">PetOwner_persona.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Arrays.stream(persona.petNames).forEach(petName -&gt; {
    PetSpecies randomSpecies = fakeDataService.enums().anyOf(PetSpecies.class);
    petOwner.addPet(petName, randomSpecies);
});</code></pre>
</div>
</div>
</li>
<li>
<p>add in an optional <code>notes</code> property:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Notes
@Column(length = Notes.MAX_LEN, nullable = true)
@Getter @Setter
@Property(commandPublishing = Publishing.ENABLED, executionPublishing = Publishing.ENABLED)
@PropertyLayout(fieldSetId = "details", sequence = "2")
private String notes;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s also update the column order files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>update the column order file for <code>PetOwner</code> (used to render standalone lists of objects returned by an action):</p>
<div class="listingblock">
<div class="title">Pet.columnOrder.txt</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">petOwner
name
species
#notes
#id
#version</code></pre>
</div>
</div>
</li>
<li>
<p>update the column order file for <code>Pet#pets</code> collection:</p>
<div class="listingblock">
<div class="title">PetOwner#pets.columnOrder.txt</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">name
species
#notes
#id
#version
#petOwner</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Run the application, confirm it runs up ok and that the new properties of <code>Pet</code> are present and correct.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="exercise-4-8-dynamic-icons-for-pet"><a class="anchor" href="#exercise-4-8-dynamic-icons-for-pet"></a>Ex 4.8: Add dynamic icons for Pet</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now for a bit of UI candy.</p>
</div>
<div class="paragraph">
<p>Currently, our icon for <code>Pet</code>s is fixed.
But we now have different species of <code>Pet</code>, so it would be nice if the icon could reflect this for each <code>Pet</code> instance as it is rendered.</p>
</div>
<div class="paragraph">
<p>This is what we&#8217;ll quickly tackle in this exercise.</p>
</div>
<div class="sect2">
<h3 id="solution-8"><a class="anchor" href="#solution-8"></a>Solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git checkout tags/3.2.0/04-08-dynamic-icons
mvn clean install
mvn -pl webapp spring-boot:run -Dspring-boot.run.jvmArguments="-Dspring.profiles.active=dev"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="tasks-8"><a class="anchor" href="#tasks-8"></a>Tasks</h3>
<div class="ulist">
<ul>
<li>
<p>download additional icons for each of the <code>PetSpecies</code> (dog, cat, hamster, budgerigar)</p>
</li>
<li>
<p>save these icons as <code>Pet-dog.png</code>, <code>Pet-cat.png</code> and so on, ie the pet species as suffix.</p>
</li>
<li>
<p>implement the <a href="../../../refguide/latest/applib-methods/ui-hints.html#iconName" class="xref page">iconName()</a> method as follows:</p>
<div class="listingblock">
<div class="title">Pet.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ObjectSupport
public String iconName() {
    return getSpecies().name().toLowerCase();
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Run the application.
You should find that the appropriate icon is selected based upon the species of the <code>Pet</code>.</p>
</div>
</div>
</div>
</div>
</article>
<aside class="article-aside toc hide-for-print" role="navigation">
    <p class="toc-title">On this page</p>
    <div id="article-toc"></div>
</aside>
</main>
</div>
<footer class="footer">
    <div class="content">
        <div class="copyright">
            <p>
                Copyright © 2010~2024 The Apache Software Foundation, licensed under the Apache License, v2.0.
                <br/>
                Apache, the Apache feather logo, Apache Causeway, and the Apache Causeway project logo are all trademarks of The Apache Software Foundation.
            </p>
        </div>
        <div class="revision">
            <p>Revision: 3.5.0-SNAPSHOT.20251007-0250-e045730d</p>
        </div>
    </div>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/jquery-3.4.1.min.js"></script>
<script src="../../../_/js/vendor/jquery-ui-1.12.1.custom.widget-only.min.js"></script>
<script src="../../../_/js/vendor/jquery.tocify.min.js"></script>

<script>
    $(function() {
        $("#article-toc").tocify( {
            showEffect: "slideDown",
            hashGenerator: "pretty",
            hideEffect: "slideUp",
            selectors: "h2, h3",
            scrollTo: 120,
            smoothScroll: true,
            theme: "jqueryui",
            highlightOnScroll: true
        } );
    });
</script>

<script src="../../../_/js/vendor/docsearch.min.js"></script>
<script>
  function focusSearchInput () { document.querySelector('#algolia-search-input').focus() }
  var search = docsearch({
    appId: '5ISP5TFAEN',
    apiKey: '0fc51c28b4ad46e7318e96d4e97fab7c',
    indexName: 'causeway-apache-org',
    inputSelector: '#algolia-search-input',
    autocompleteOptions: { hint: false, keyboardShortcuts: ['s'] },
    debug: false,
  }).autocomplete
  search.on('autocomplete:closed', function () { search.autocomplete.setVal() })
  focusSearchInput()
  window.addEventListener('load', focusSearchInput);
</script>

<!--
  docsearch options:
  https://docsearch.algolia.com/docs/behavior/
-->
<!--
  https://www.algolia.com/doc/api-reference/api-parameters/
  algoliaOptions: { hitsPerPage: 6 },
-->
  </body>
</html>
