<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Unit Test Support :: Apache Isis</title>
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="stylesheet" href="../../../_/css/site-custom.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i|Raleway:300,400,500,700,800|Montserrat:300,400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"/>
<link rel="home" href="../../.." title="Apache Isis">
  <link rel="next" href="../integtestsupport/about.html" title="Integ Test Support">
  <link rel="prev" href="../about.html" title="Testing Guide">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../..">
          <span class="icon">
            <img src="../../../_/img/isis-logo-48x48.png"></img>
          </span>
        <span>Apache Isis</span>
      </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <a class="navbar-end">
        <div class="navbar-item hide-for-print">
          <span>
            <input id="algolia-search-input" placeholder="Search"></span>
          </span>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Quick Start</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Starter Apps</span>
            <a class="navbar-item" href="../../../docs/2.0.0-M7/starters/helloworld.html">Hello World</a>
            <a class="navbar-item" href="../../../docs/2.0.0-M7/starters/simpleapp.html">Simple App</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Demos &amp; Tutorials</span>
            <a class="navbar-item" href="../../../docs/2.0.0-M7/demo/about.html">Demo App</a>
            <a class="navbar-item" href="https://danhaywood.gitlab.io/isis-petclinic-tutorial-docs/petclinic/1.16.2/intro.html">Petclinic (tutorial)</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Resources</span>
            <a class="navbar-item" href="../../../docs/2.0.0-M7/resources/cheatsheet.html">Cheatsheet</a>
            <a class="navbar-item" href="../../../docs/2.0.0-M7/resources/icons.html">Icons</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Guides</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Development</span>
            <a class="navbar-item" href="../../../setupguide/2.0.0-M7/about.html">Setup Guide</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Core</span>
            <a class="navbar-item" href="../../../userguide/2.0.0-M7/about.html">User Guide</a>
            <a class="navbar-item" href="../../../refguide/2.0.0-M7/about.html">Reference Guide</a>
            <a class="navbar-item" href="../../../testing/2.0.0-M7/about.html">Testing Guide</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Components</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Viewers</span>
            <a class="navbar-item" href="../../../vw/2.0.0-M7/about.html">Web UI (Wicket)</a>
            <a class="navbar-item" href="../../../vro/2.0.0-M7/about.html">REST API (Restful Objects)</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Persistence</span>
            <a class="navbar-item" href="../../../pjpa/2.0.0-M7/about.html">JPA (EclipseLink)</a>
            <a class="navbar-item" href="../../../pjdo/2.0.0-M7/about.html">JDO (DataNucleus)</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Security</span>
            <a class="navbar-item" href="../../../security/2.0.0-M7/about.html">Security Guide</a>
            <hr class="navbar-divider"/>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Libraries</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">For Use in Apps</span>
            <a class="navbar-item" href="../../../subdomains/2.0.0-M7/about.html">Subdomain Libraries</a>
            <a class="navbar-item" href="../../../valuetypes/2.0.0-M7/about.html">Value Type Catalog</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Integrate between Apps</span>
            <a class="navbar-item" href="../../../mappings/2.0.0-M7/about.html">Bounded Context Mapping Libraries</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Extending the framework itself</span>
            <a class="navbar-item" href="../../../extensions/2.0.0-M7/about.html">Extensions Catalog</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Support</a>
          <div class="navbar-dropdown">
            <span class="navbar-item navbar-heading">Contact</span>
            <a class="navbar-item" href="../../../docs/2.0.0-M7/support/slack-channel.html">Slack</a>
            <a class="navbar-item" href="../../../docs/2.0.0-M7/support/mailing-list.html">Mailing Lists</a>
            <a class="navbar-item" href="https://issues.apache.org/jira/browse/ISIS">JIRA</a>
            <a class="navbar-item" href="https://stackoverflow.com/questions/tagged/isis">Stack Overflow</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Releases</span>
            <a class="navbar-item" href="../../../docs/2.0.0-M7/downloads/how-to.html">Downloads</a>
            <a class="navbar-item" href="../../../relnotes/2.0.0-M7/about.html">Release Notes</a>
            <a class="navbar-item" href="../../../docs/2.0.0-M7/archive/1-x.html">Archive (1.x)</a>
            <hr class="navbar-divider"/>
            <span class="navbar-item navbar-heading">Framework</span>
            <a class="navbar-item" href="../../../conguide/2.0.0-M7/about.html">Contributors' Guide</a>
            <a class="navbar-item" href="../../../comguide/2.0.0-M7/about.html">Committers' Guide</a>
            <a class="navbar-item" href="../../../core/2.0.0-M7/about.html">Core Design</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">ASF</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="http://www.apache.org/">Apache Homepage</a>
            <a class="navbar-item" href="https://www.apache.org/events/current-event">Events</a>
            <a class="navbar-item" href="https://www.apache.org/licenses/">Licenses</a>
            <a class="navbar-item" href="https://www.apache.org/security/">Security</a>
            <a class="navbar-item" href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a>
            <a class="navbar-item" href="https://www.apache.org/foundation/thanks.html">Thanks</a>
            <hr class="navbar-divider"/>
            <a class="navbar-item" href="https://whimsy.apache.org/board/minutes/Isis.html">PMC board minutes</a>
          </div>
        </div>
        <a class="navbar-item" href="../../../docs/2.0.0-M7/about.html">
          <span class="icon">
            <img src="../../../_/img/home.png"></img>
          </span>
        </a>
      </div>
    </div>
  </nav>
</header>
<div class="body ">
<div class="nav-container" data-component="testing" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-pagination">
  <a class="page-previous" rel="prev" href="../about.html" title="Testing Guide"><span></span></a>
  <a class="page-next" rel="next"
     href="../integtestsupport/about.html" title="Integ Test Support"><span></span></a>
<!--
page.parent doesn't seem to be set...
  <a class="page-parent disabled" rel="prev" href="" title="Testing Guide"><span></span></a>
-->
</div>
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../about.html">Testing Guide</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="about.html">Unit Test Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../integtestsupport/about.html">Integ Test Support</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integtestsupport/domain-model-validator.html">Domain Model Validator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integtestsupport/swagger-exporter.html">Swagger Exporter</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../specsupport/about.html">BDD Spec Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../fixtures/about.html">Fixture Scripts</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../fakedata/about.html">Fakedata</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../archtestsupport/about.html">Architecture Test Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../h2console/about.html">H2 Console</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../hsqldbmgr/about.html">HSQLDB Manager</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Testing Guide</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title"> </span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../docs/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">BC Mapping Libraries</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../mappings/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Committers' Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../comguide/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Contributors' Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../conguide/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Design Docs</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../core/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Extensions Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../extensions/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Incubator Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../incubator/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">JDO/DataNucleus</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../pjdo/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">JPA</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../pjpa/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Reference Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../refguide/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Release Notes</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../relnotes/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">REST API (Restful Objects Viewer)</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../vro/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Security Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../security/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Setup Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../setupguide/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Subdomains Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../subdomains/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Testing Guide</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Tooling</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../tooling/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">User Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../userguide/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Value Types Catalog</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../valuetypes/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Web UI (Wicket Viewer)</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../vw/latest/about.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main role="main">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../docs/latest/about.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../about.html">Testing Guide</a></li>
    <li><a href="about.html">Unit Test Support</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/apache/isis/edit/master/testing/unittestsupport/adoc/modules/unittestsupport/pages/about.adoc">Edit</a></div>
</div>
<article class="doc">
    <a name="section-top"></a>
<h1 class="page">Unit Test Support</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Apache Isis provides a number of helpers to help unit test your domain objects.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="maven-configuration"><a class="anchor" href="#maven-configuration"></a>Maven Configuration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="dependency-management"><a class="anchor" href="#dependency-management"></a>Dependency Management</h3>
<div class="paragraph">
<p>If your application inherits from the Apache Isis starter app (<code>org.apache.isis.app:isis-app-starter-parent</code>) then that will define the version automatically:</p>
</div>
<div class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;parent&gt;
    &lt;groupId&gt;org.apache.isis.app&lt;/groupId&gt;
    &lt;artifactId&gt;isis-app-starter-parent&lt;/artifactId&gt;
    &lt;version&gt;2.0.0-M7&lt;/version&gt;
    &lt;relativePath/&gt;
&lt;/parent&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, import the core BOM.
This is usually done in the top-level parent pom of your application:</p>
</div>
<div class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependencyManagement&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.isis.core&lt;/groupId&gt;
            &lt;artifactId&gt;isis-core&lt;/artifactId&gt;
            &lt;version&gt;2.0.0-M7&lt;/version&gt;
            &lt;scope&gt;import&lt;/scope&gt;
            &lt;type&gt;pom&lt;/type&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/dependencyManagement&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition, add a section for the BOM of all the testing support libraries:</p>
</div>
<div class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependencyManagement&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
        	&lt;groupId&gt;org.apache.isis.testing&lt;/groupId&gt;
	        &lt;artifactId&gt;isis-testing&lt;/artifactId&gt;
            &lt;scope&gt;import&lt;/scope&gt;
            &lt;type&gt;pom&lt;/type&gt;
            &lt;version&gt;2.0.0-M7&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/dependencyManagement&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dependencies"><a class="anchor" href="#dependencies"></a>Dependencies</h3>
<div class="paragraph">
<p>In the domain module(s) of your application, add the following dependency:</p>
</div>
<div class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.isis.testing&lt;/groupId&gt;
        &lt;artifactId&gt;isis-testing-unittestsupport-applib&lt;/artifactId&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>We also highly recommend using the <a href="../fakedata/about.html" class="page">Fakedata</a> library for random values in your tests:</p>
</div>
<div class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.isis.testing&lt;/groupId&gt;
        &lt;artifactId&gt;isis-testing-fakedata-applib&lt;/artifactId&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <a href="../../../docs/latest/parent-pom/about.html" class="page">Parent POM</a> configures the Maven surefire plugin in three separate executions for unit tests, integ tests and for BDD specs.
This relies on a naming convention:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>unit tests, which must have the name <code>*Test*</code>, but excluding &#8230;&#8203;</p>
</li>
<li>
<p>integ tests, which must have the name <code>*IntegTest*</code></p>
</li>
<li>
<p>BDD integ specs, which must have the name <code>*Spec*</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Classes named <code>*Abstract*</code> are always ignored.</p>
</div>
<div class="paragraph">
<p>Not following this convention (intermixing unit tests with integ tests) may cause the latter to fail.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="update-appmanifest"><a class="anchor" href="#update-appmanifest"></a>Update AppManifest</h3>
<div class="paragraph">
<p>In your application&#8217;s <code>AppManifest</code> (top-level Spring <code>@Configuration</code> used to bootstrap the app), import the <code>IsisModuleTestingUnitTestSupportApplib</code> module:</p>
</div>
<div class="listingblock">
<div class="title">AppManifest.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Configuration
@Import({
        ...
        IsisModuleTestingUnitTestSupportApplib.class,
        ...
})
public class AppManifest {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>(In fact, this is optional; the classes in the unit test support library can be used outside of a running application).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="pojotester"><a class="anchor" href="#pojotester"></a>PojoTester</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <a href="../../../refguide/latest/testing/index/unittestsupport/applib/dom/pojo/PojoTester.html" class="page">PojoTester</a> utility automates the testing of getters and setters.</p>
</div>
<div class="paragraph">
<p>As getters and setters are so simple, the intention of automating their testing is not to discover defects (though if there are unintentional side-effects, then these will be found).
Instead, the rationale of testing getters and setters is to increase code coverage.
Any substantial gap away from 100% would therefore due to significant functionality not having tests (as opposed to merely getters and setters not being tested).</p>
</div>
<div class="paragraph">
<p>The class has built-in support for primitives and most of the other value types already recognised by the framework, and provides a mechanism to allow example instances for any application-specific types.</p>
</div>
<div class="paragraph">
<p>For example, given a class:</p>
</div>
<div class="listingblock">
<div class="title">Customer.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Getter @Setter
public class Customer {
    private int custNum;
    private String name;
    private Date registeredOn;
    private Address address;
    private List&lt;Order&gt; orders;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>then all of the getters and setters can be exercised using:</p>
</div>
<div class="listingblock">
<div class="title">Customer.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class Customer_Test {

    @Test
    void exercise_getters_and_setters() {
        PojoTester.create()
            .usingData(Address.class, Address.class)    <i class="conum" data-value="1"></i><b>(1)</b>
            .usingData(Order.class, Order.class)        <i class="conum" data-value="1"></i><b>(1)</b>
            .exercise();
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>provides the compile-time and run-time types of the referenced objects.
The runtime-type must provide a no-arg constructor.
<div class="paragraph">
<p>In many cases (as here) the same type can be used for both parameters.</p>
</div></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There are several overloads of the <code>usingData(&#8230;&#8203;)</code> method, one of which accepts a <code>PojoTester.DatumFactory</code> instance.
This interface provides a more flexible way to provide arbitrary datum instances for a specified type.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="contract-tests"><a class="anchor" href="#contract-tests"></a>Contract Tests</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Contract tests ensure that all instances of a particular idiom/pattern that occur within your codebase are implemented correctly.
You could think of them as being a way to enforce a certain type of coding standard.</p>
</div>
<div class="sect2">
<h3 id="sortedsets"><a class="anchor" href="#sortedsets"></a><code>SortedSet</code>s</h3>
<div class="paragraph">
<p>This contract test automatically checks that all fields of type <code>java.util.Collection</code> are declared as <code>java.util.SortedSet</code>.
In other words, it precludes either <code>java.util.List</code> or <code>java.util.Set</code> from being used as a collection.</p>
</div>
<div class="paragraph">
<p>For example, the following passes the contract test:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class Department {
    private SortedSet&lt;Employee&gt; employees = new TreeSet&lt;Employee&gt;();
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>whereas this would not:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class SomeDomainObject {
    private List&lt;Employee&gt; employees = new ArrayList&lt;Employee&gt;();
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To use the contract test, subclass <code>SortedSetsContractTestAbstract</code>, specifying the root package to search for domain classes.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class SortedSetsContractTestAll extends SortedSetsContractTestAbstract {

    public SortedSetsContractTestAll() {
        super("com.mycompany.myapp.modules");
        withLoggingTo(System.out);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If using an RDBMS for persistence then we strongly recommend that you implement this test, for several reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>first, <code>Set</code>s align more closely to the relational model than do <code>List</code>s.
A <code>List</code> must have an additional index to specify order.</p>
</li>
<li>
<p>second, <code>SortedSet</code> is preferable to <code>Set</code> because then the order is well-defined and predictable (to an end user, to the programmer).</p>
<div class="paragraph">
<p>The <a href="../../../refguide/latest/applib/index/util/ObjectContracts.html" class="page">ObjectContracts</a>  utility class substantially simplifies the task of implementing <code>Comparable</code> in your domain classes.</p>
</div>
</li>
<li>
<p>third, if the relationship is bidirectional then the ORM (JDO/DataNucleus) will automatically maintain the relationship.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="comparable"><a class="anchor" href="#comparable"></a>Comparable</h3>
<div class="paragraph">
<p>TODO
ComparableContractTest_compareTo</p>
</div>
</div>
<div class="sect2">
<h3 id="value-objects"><a class="anchor" href="#value-objects"></a>Value Objects</h3>
<div class="paragraph">
<p>The <a href="../../../refguide/latest/testing/index/unittestsupport/applib/dom/value/ValueTypeContractTestAbstract.html" class="page">ValueTypeContractTestAbstract</a> tests that a custom value type implements <code>equals()</code> and <code>hashCode()</code> correctly.</p>
</div>
<div class="paragraph">
<p>For example, testing JDK&#8217;s own <code>java.math.BigInteger</code> can be done as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class ValueTypeContractTestAbstract_BigIntegerTest extends ValueTypeContractTestAbstract&lt;BigInteger&gt; {

    @Override
    protected List&lt;BigInteger&gt; getObjectsWithSameValue() {      <i class="conum" data-value="1"></i><b>(1)</b>
        return Arrays.asList(new BigInteger("1"), new BigInteger("1"));
    }

    @Override
    protected List&lt;BigInteger&gt; getObjectsWithDifferentValue() { <i class="conum" data-value="2"></i><b>(2)</b>
        return Arrays.asList(new BigInteger("2"));
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Returns a list of different instances that are expected to have the same value (according to equals and hashCode).</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Returns a list of instances that are different from each other and also from the instance(s) provided in the <code>getObjectsWithSameValue()</code> method.
As here, it is often sufficient to provide a single instance (as it is compared against the instances provided by <code>getObjectsWithSameValue()</code>.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="xml-marshalling-support"><a class="anchor" href="#xml-marshalling-support"></a>XML Marshalling Support</h3>
<div class="paragraph">
<p>Apache Isis' unit testing support provides the <a href="#refguide:testing:index/unittestsupport/applib/matchers">JaxbMatchers</a> while the core applib also provides the useful <a href="../../../refguide/latest/applib/index/util/JaxbUtil.html" class="page">JaxbUtil</a> class.</p>
</div>
<div class="paragraph">
<p>These can be useful for example if you have example XML-serialized representations of the SOAP requests and response payloads and want to use these within your tests.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jmock-extensions"><a class="anchor" href="#jmock-extensions"></a>JMock Extensions</h2>
<div class="sectionbody">
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The JMock extensions are deprecated; we suggest you use Mockito instead.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you use mocking, then  usual given/when/then format gets an extra step:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>given</strong> the system is in this state</p>
</li>
<li>
<p><strong>expecting</strong> these interactions (set up the mock expectations here)</p>
</li>
<li>
<p><strong>when</strong> I poke it with a stick</p>
</li>
<li>
<p><strong>then</strong> these state changes and interactions with Mocks should have occurred.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If using JMock then the interactions (in the "then") are checked automatically by a JUnit rule.
However, you probably will still have some state changes to assert upon.</p>
</div>
<div class="paragraph">
<p>Apache Isis' unit test support provides <code>JUnitRuleMockery2</code> which is an extension to the <a href="http://www.jmock.org/">JMock</a>'s <code>JunitRuleMockery</code>.
It provides a simpler API and also providing support for autowiring.</p>
</div>
<div class="paragraph">
<p>For example, here we see that the class under test, an instance of <code>CollaboratingUsingSetterInjection</code>, is automatically wired up with its <code>Collaborator</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class JUnitRuleMockery2Test_autoWiring_setterInjection_happyCase {

    @Rule
    public JUnitRuleMockery2 context = JUnitRuleMockery2.createFor(Mode.INTERFACES_AND_CLASSES);

    @Mock
    private Collaborator collaborator;

    @ClassUnderTest
    private CollaboratingUsingSetterInjection collaborating;

    @Test
    public void wiring() {
        assertThat(collaborating.collaborator, is(not(nullValue())));
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Distinguish between queries vs mutators</div>
<div class="paragraph">
<p>For mock interactions that simply retrieve some data, your test should not need to verify that it occurred.
If the system were to be refactored and starts caching some data, you don&#8217;t really want your tests to start breaking because they are no longer performing a query that once they did.
If using JMock API this means using the <code>allowing(..)</code> method to set up the expectation.</p>
</div>
<div class="paragraph">
<p>On the other hand mocks that mutate the state of the system you probably should assert have occurred.
If using JMock this typically means using the <code>oneOf(&#8230;&#8203;)</code> method.</p>
</div>
<div class="paragraph">
<p>For more tips on using JMock and mocking in general, check out the <a href="http://www.growing-object-oriented-software.com/">GOOS</a> book, written by JMock&#8217;s authors, Steve Freeman and Nat Pryce and also <a href="http://natpryce.com/articles.html">Nat&#8217;s blog</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="utilities-classes"><a class="anchor" href="#utilities-classes"></a>Utilities classes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The unittestsupport library also includes a number of miscellaneous utilities classes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../../../refguide/latest/testing/index/unittestsupport/applib/util/CollectUtils.html" class="page">CollectUtils</a></p>
</li>
<li>
<p><a href="../../../refguide/latest/testing/index/unittestsupport/applib/util/FileUtils.html" class="page">FileUtils</a></p>
</li>
<li>
<p><a href="../../../refguide/latest/testing/index/unittestsupport/applib/util/InjectUtils.html" class="page">InjectUtils</a></p>
</li>
<li>
<p><a href="../../../refguide/latest/testing/index/unittestsupport/applib/util/ReflectUtils.html" class="page">ReflectUtils</a></p>
</li>
<li>
<p><a href="../../../refguide/latest/testing/index/unittestsupport/applib/util/StringUtils.html" class="page">StringUtils</a></p>
</li>
</ul>
</div>
</div>
</div>
</article>
<aside class="article-aside toc hide-for-print" role="navigation">
    <p class="toc-title">On this page</p>
    <div id="article-toc"></div>
</aside>
</main>
</div>
<footer class="footer">
    <div class="content">
        <div class="copyright">
            <p>
                Copyright Â© 2010~2021 The Apache Software Foundation, licensed under the Apache License, v2.0.
                <br/>
                Apache, the Apache feather logo, Apache Isis, and the Apache Isis project logo are all trademarks of The Apache Software Foundation.
            </p>
        </div>
        <div class="revision">
            <p>Revision: 2.0.0-M6.20210918-0230-42ee7d40</p>
        </div>
    </div>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/jquery-3.4.1.min.js"></script>
<script src="../../../_/js/vendor/jquery-ui-1.12.1.custom.widget-only.min.js"></script>
<script src="../../../_/js/vendor/jquery.tocify.min.js"></script>

<script>
    $(function() {
        $("#article-toc").tocify( {
            showEffect: "slideDown",
            hashGenerator: "pretty",
            hideEffect: "slideUp",
            selectors: "h2, h3",
            scrollTo: 120,
            smoothScroll: true,
            theme: "jqueryui",
            highlightOnScroll: true
        } );
    });
</script>

<script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script>
  function focusSearchInput () { document.querySelector('#algolia-search-input').focus() }
  var search = docsearch({
    appId: '5ISP5TFAEN',
    apiKey: '0fc51c28b4ad46e7318e96d4e97fab7c',
    indexName: 'isis-apache-org',
    inputSelector: '#algolia-search-input',
    autocompleteOptions: { hint: false, keyboardShortcuts: ['s'] },
    debug: false,
  }).autocomplete
  search.on('autocomplete:closed', function () { search.autocomplete.setVal() })
  focusSearchInput()
  window.addEventListener('load', focusSearchInput);
</script>

<!--
  docsearch options:
  https://docsearch.algolia.com/docs/behavior/
-->
<!--
  https://www.algolia.com/doc/api-reference/api-parameters/
  algoliaOptions: { hitsPerPage: 6 },
-->
  </body>
</html>
